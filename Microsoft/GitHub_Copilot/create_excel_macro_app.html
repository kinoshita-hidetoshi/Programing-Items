<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="author" content="kinoshita hidetoshi (木下 英俊)">
  <meta name="description" content="木下英俊が自身のためにプログラムメモを残すことを目的に作成したページです">
  <meta name="keywords" content="">
  <!-- キャッシュ無効化 -->
  <meta http-equiv="Cache-Control" content="no-cache">
	
  <!-- タイトル -->
  <title>[GitHub Copilot] Excel マクロアプリを作成する | Programming Items</title>
	
  <!-- ファビコン -->
  <link rel="shortcut icon" href="../../favicon.ico">
  
  <!-- CSS -->
  <link href="https://unpkg.com/ress/dist/ress.min.css" rel="stylesheet">
	<link rel="stylesheet" href="../../design.css" type="text/css">
  
	<!-- Start for 'google-code-prettify' -->
	<link href="../../prettify/styles/desert.css" rel="stylesheet" type="text/css">
	<script src="../../prettify/prettify.js" type="text/javascript"></script>
	<script src="../../prettify/lang-vb.js" type="text/javascript"></script>
	<script src="../../prettify/lang-yaml.js" type="text/javascript"></script>
	<!-- End for 'google-code-prettify' -->	
	
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-V2DZQK54C2"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'G-V2DZQK54C2');
  </script>
  <!-- Global site tag (gtag.js) - Google Analytics -->

</head>

<body onload="prettyPrint();">
	
  <h1>[GitHub Copilot] Excel マクロアプリを作成する</h1>
  
  <p> <strong>GitHub Copilot</strong> を使って、簡単な <strong>Excel</strong> マクロアプリを作成してみました。こちらで紹介します。</p>
  
  <p>全作業を５分ぐらいで完了しました。</p>
  <p>&nbsp;</p>
  
  <div class="mokuji">
    <nav>
    	<h2>目次</h2>
    	<p><a href="#1.作成した_Excel_マクロアプリ_">1.作成した_Excel_マクロアプリ_</a></p>
        <p><a href="#2._GitHub_Copilot_へのお願い方法_">2._GitHub_Copilot_へのお願い方法</a></p>
        <p><a href="#3._GitHub_Copilot_の出力内容">3._GitHub_Copilot_の出力内容</a></p>
        <p>&nbsp;&nbsp; <a href="#3-1._TimeDisplayMacro.bas">
        3-1._TimeDisplayMacro.bas</a></p>
        <p>&nbsp;&nbsp; <a href="#3-2._README.md">3-2._README.md</a></p>
        <p><a href="#4._後書き">4._後書き</a></p>
    	<p>&nbsp;</p>
    	<p><a href="#ライセンス">ライセンス</a></p>
    	<p><a href="#参考">参考</a></p>
    </nav>
  </div>
  
  <p>&nbsp;</p>
  <p>&nbsp;</p>
  
  <section>
  	<h2> <a name="1.作成した_Excel_マクロアプリ_">1.作成した Excel マクロアプリ </a> </h2>
  	<p>1秒周期で現在時刻を表示する、という簡単な内容です。</p>
    <p>&nbsp;</p>
    <p><strong>作成した Excel マクロアプリ</strong>： こちらに添付します </p>
    <a href="create_excel_macro_app/TimeDisplayApp.xlsm">TimeDisplayApp.xlsm</a><p>
    &nbsp;</p>
    
  	<p>こちら、実際に動作させてみた動画です。 </p>
    <video controls muted autoplay="y" loop="y" width="800">
      <source src="create_excel_macro_app/Show_and_update_date_and_time.mp4" type="video/mp4">
      動画を再生するには &lt;video&gt; タグをサポートしたブラウザが必要です。
    </video>
    
    <p>[動画] "Excelマクロ_現在時刻を1秒更新.mp4"</p>
    <p>&nbsp;</p>
    <p>&nbsp;</p>
	
  </section>
  	
  <section>
  	<h2> <a name="2._GitHub_Copilot_へのお願い方法_">2. GitHub Copilot へのお願い方法 </a> </h2>
  	<p>下記のように依頼してみました。</p>
    
    <blockquote style="width:800px">
      excel マクロアプリを作成したい。1秒ごとに現在時刻を更新して表示して。
    </blockquote>
    
    <p>&nbsp;</p>
    <p><img alt="vscode 画面" src="create_excel_macro_app/img13.jpg" width="1000px"></p>
    <p>図： 実際の画面（vscode にて）</p>
    <p>&nbsp;</p>
	
  </section>
  	
  <p>&nbsp;</p>
    
  <section>
  	<h2> <a name="3._GitHub_Copilot_の出力内容">3. GitHub Copilot の出力内容</a></h2>
    <p> GitHub Copilot から実際に出力された例を以下に紹介します。 </p>
  	<h4>&nbsp;</h4>
    <h3><a name="3-1._TimeDisplayMacro.bas">3-1. TimeDisplayMacro.bas</a></h3>
    
    <pre class="prettyprint linenums lang-vb" style="width:800px">
Option Explicit

' 次回実行時刻を保存する変数
Dim NextRunTime As Date
Dim IsRunning As Boolean

' 1秒ごとに現在時刻を更新
Sub StartTimeDisplay()
    ' すでにタイマーが動いている場合は停止
    If IsRunning Then
        StopTimeDisplay
    End If
    
    ' セルA1に時刻を表示
    Range("A1").Value = "現在時刻:"
    Range("A1").Font.Bold = True
    Range("A1").Font.Size = 14
    
    Range("B1").Font.Size = 14
    Range("B1").NumberFormat = "yyyy/mm/dd hh:mm:ss"
    
    ' 列幅を自動調整
    Columns("A:B").AutoFit
    
    ' 実行フラグを立てる
    IsRunning = True
    
    ' 初回の時刻表示
    UpdateTime
    
    MsgBox "時刻表示を開始しました。停止するには StopTimeDisplay を実行してください。", vbInformation
End Sub

' 時刻を更新する処理
Sub UpdateTime()
    On Error Resume Next
    
    ' 実行中でなければ終了
    If Not IsRunning Then Exit Sub
    
    ' セルB1に現在時刻を表示
    ThisWorkbook.Sheets(1).Range("B1").Value = Now
    
    ' 次の更新をスケジュール(1秒後)
    NextRunTime = Now + TimeValue("00:00:01")
    Application.OnTime NextRunTime, "UpdateTime"
End Sub

' 時刻表示を停止
Sub StopTimeDisplay()
    On Error Resume Next
    
    ' 実行フラグを下げる
    IsRunning = False
    
    ' スケジュールされたタイマーをキャンセル
    If NextRunTime &gt; 0 Then
        Application.OnTime EarliestTime:=NextRunTime, _
                            Procedure:="UpdateTime", _
                            Schedule:=False
    End If
    
    MsgBox "時刻表示を停止しました。", vbInformation
End Sub</pre>
    <p>&nbsp;</p>
    <p>&nbsp;</p>
    <h3><a name="3-2._README.md">3-2. README.md</a></h3>
    
    <pre class="prettyprint linenums lang-yaml" style="width:800px">
# Excel 時刻表示マクロアプリ

## 概要

1秒ごとに現在時刻を更新して表示するExcelマクロアプリケーションです。

## セットアップ手順

1. **新しいExcelブックを作成**
   - Excelを開いて新規ブックを作成します

2. **VBAエディタを開く**
   - `Alt + F11` を押してVBAエディタを開きます

3. **標準モジュールを追加**
   - メニューから「挿入」→「標準モジュール」を選択

4. **コードを貼り付け**
   - `TimeDisplayMacro.bas` の内容をモジュールにコピー&amp;ペーストします

5. **マクロ有効ブックとして保存**
   - ファイル名: `TimeDisplayApp.xlsm`
   - ファイル形式: Excelマクロ有効ブック (*.xlsm)

## 使用方法

### 時刻表示を開始

1. `Alt + F8` を押してマクロ一覧を表示
2. `StartTimeDisplay` を選択して「実行」をクリック
3. セルA1に「現在時刻:」、セルB1に現在時刻が表示され、1秒ごとに更新されます

### 時刻表示を停止

1. `Alt + F8` を押してマクロ一覧を表示
2. `StopTimeDisplay` を選択して「実行」をクリック

## 機能説明

- **StartTimeDisplay**: 時刻表示を開始します
  - セルA1にラベル「現在時刻:」を表示
  - セルB1に現在時刻を「yyyy/mm/dd hh:mm:ss」形式で表示
  - 1秒ごとに自動更新

- **UpdateTime**: 時刻を更新する内部処理
  - 1秒ごとに自動的に呼び出されます

- **StopTimeDisplay**: 時刻表示を停止します

## 注意事項

- マクロを実行するには、Excelのセキュリティ設定でマクロを有効にする必要があります
- ファイルを閉じる前に `StopTimeDisplay` を実行することを推奨します
- ブックを保存する際は、マクロ有効ブック (.xlsm) 形式で保存してください

## トラブルシューティング

**マクロが実行できない場合:**

- 「ファイル」→「オプション」→「セキュリティセンター」→「セキュリティセンターの設定」
- 「マクロの設定」で「すべてのマクロを有効にする」または「警告を表示してすべてのマクロを無効にする」を選択

**時刻が更新されない場合:**

- 一度 `StopTimeDisplay` を実行してから、再度 `StartTimeDisplay` を実行してください</pre>

    <p>&nbsp;</p>
	
  </section>
  	
  <p>&nbsp;</p>
    
  <section>
  	<h2> <a name="4._後書き">4. 後書き</a> </h2>
  	<p><strong>GitHub Copilot</strong> を使って <strong>Excel</strong> マクロアプリを作成する、ということを試してみました。</p>
    <p>残念ながら <strong>GitHub Copilot</strong> は <strong>Excel</strong> 
    ファイルおよびマクロを直接作成まで行ってはくれませんでしたが、若干の手操作だけで短時間でアプリケーション作成することができました。 </p>
    <p>ちょっとした Excel ツールを作成するという場面は、多くの方が時々？頻繁に行っているのではと考えます。<strong>GitHub 
    Copilot</strong> を活用することでとても効率よく短時間で作成することができましたので、よかったら参考にしてみてください。 </p>
    <p>&nbsp;</p>
	
  </section>
  	
  <p>&nbsp;</p>

  <section>
    <h2><a id="ライセンス">ライセンス</a></h2>
    <p>本ページの情報は、特記無い限り下記 MIT ライセンスで提供されます。</p>
    <div class="license">
      The MIT License (MIT)<br><br>
      
      &nbsp; Copyright 2025 Kinoshita Hidetoshi<br><br>
      
      Permission is hereby granted, free of charge, to any person obtaining a copy
      of this software and associated documentation files (the "Software"), to deal
      in the Software without restriction, including without limitation the rights
      to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
      copies of the Software, and to permit persons to whom the Software is
      furnished to do so, subject to the following conditions:<br><br>
      
      The above copyright notice and this permission notice shall be included in all
      copies or substantial portions of the Software.<br><br>
      
      THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
      IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
      FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
      AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
      LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
      OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
      SOFTWARE.
    </div>
    <p>&nbsp;</p>
  </section>
  
  <p> &nbsp;</p>
  
  <section>
  	<h2><a id="参考">参考</a></h2>
  	<ul>
  		<li></li>
  	</ul>
  </section>
  
  <p>&nbsp;</p>
  <hr>
  <p>&nbsp;</p>
  
  <section>
  	<h2 style="margin-bottom:5px">変更履歴</h2>
  	<table>
  	  <tr>
  	    <td class="td_history_date">2025-11-13</td>
  	    <td class="td_history_separator">-</td>
  	    <td class="td_history">新規作成 </td>
  	  </tr>
  	</table>
  </section>
  
  <p>&nbsp;</p>
  
  <section>
    <p><a href="../../index.html" target="_parent">Programming Items トップページ</a></p>
    <p><a href="../../privacy_policy.html">プライバシーポリシー</a></p>
  </section>
  
  <p>&nbsp;</p>
  
  <footer>
  	<p><small>&copy; 2025 Kinoshita Hidetoshi (木下英俊)</small></p>
  </footer>
  
</body>
</html>
