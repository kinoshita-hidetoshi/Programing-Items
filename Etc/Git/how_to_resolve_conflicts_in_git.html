<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="author" content="kinoshita hidetoshi (木下 英俊)">
  <meta name="description" content="木下英俊が自身のためにプログラムメモを残すことを目的に作成したページです">
  <meta name="keywords" content="">
  <!-- キャッシュ無効化 -->
  <meta http-equiv="Cache-Control" content="no-cache">
	
  <!-- タイトル -->
  <title>[git] conflict を解決する方法 (vscode) | Programming Items</title>
	
  <!-- ファビコン -->
  <link rel="shortcut icon" href="../../favicon.ico">
  
  <!-- CSS -->
  <link href="https://unpkg.com/ress/dist/ress.min.css" rel="stylesheet">
	<link rel="stylesheet" href="../../design.css" type="text/css">
  
	<!-- Start for 'google-code-prettify' -->
	<link href="../../prettify/styles/desert.css" rel="stylesheet" type="text/css">
	<script src="../../prettify/prettify.js" type="text/javascript"></script>
	<!-- End for 'google-code-prettify' -->	
	
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-V2DZQK54C2"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'G-V2DZQK54C2');
  </script>
  <!-- Global site tag (gtag.js) - Google Analytics -->

  <style type="text/css">
    .auto-style1 {
      background-color: #505000;
    }
  </style>

</head>

<body onload="prettyPrint();">
	
  <h1>[git] conflict を解決する方法 (vscode)</h1>
  
  <p> <strong>git</strong> を使っていると、時々 <strong>Conflict </strong>(競合) 
  という問題に遭遇します。</p>
  
  <p>久し振りだったりすると、どうしたらよいのか、焦っちゃいますので、超簡単な例をここに記載してみたいと思います。</p>
  <p>&nbsp;</p>
  
  <div class="mokuji">
    <nav>
    	<h2>目次</h2>
    	<p><a href="#1._Git_の_Conflict（競合）とは">1. Git の Conflict（競合）とは</a></p>
    	<p><a href="#2._Conflict_解決手順">2. Conflict 解決手順</a></p>
    	<p>&nbsp;</p>
    	<p><a href="#ライセンス">ライセンス</a></p>
    	<p><a href="#参考">参考</a></p>
    </nav>
  </div>
  
  <p>&nbsp;</p>
  <p>&nbsp;</p>
  
  <section>
  	<h2> <a name="1._Git_の_Conflict（競合）とは">1. Git の Conflict（競合）とは</a></h2>
  	<p>Git の conflict（競合） は、複数の変更が同じ箇所にぶつかり、Git 
    がどちらを採用すべきか判断できない状態を言います。マージやコミット、リベースのときに発生し、手動で解決する必要があります。</p>
    <p>&nbsp;</p>
    <p><strong>conflict</strong> が起きる仕組み：</p>
    <ul>
      <li>同じファイルを複数人が同時に編集してコミットした</li>
      <li>同じファイルの同じ行を複数のブランチが変更した</li>
      <li>片方で削除、もう片方で編集した</li>
      <li>自動マージが成立しない複雑な変更がある</li>
    </ul>
    <p>Git は自動で判断できないため、該当箇所にマーカーを挿入してユーザーに選択を委ねることになります。 </p>
    <p>&nbsp;</p>
    <p><strong>conflict</strong> の表示形式：</p>
    <p>ファイル内に次のようなマーカーが入ります。</p>
    <pre class="prettyprint linenums lang-cpp" style="width:800px">
&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD
あなたのブランチの変更
=======
マージしようとしているブランチの変更
&gt;&gt;&gt;&gt;&gt;&gt;&gt; feature-branch</pre>
    <ul>
      <li><span class="cpp-source">HEAD</span> 側が現在のブランチ </li>
      <li><span class="cpp-source">=======</span> で区切られている </li>
      <li><span class="cpp-source">&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span> の後ろが相手ブランチ </li>
    </ul>
    <p>&nbsp;</p>
    <p><strong>conflict</strong> の解決手順（一般的な流れ）：</p>
    <ol>
      <li>該当ファイルを開く </li>
      <li>どの内容を採用するか決める 
      <ul>
        <li>片方だけ採用 </li>
        <li>両方を統合 </li>
        <li>完全に書き直す </li>
      </ul>
      </li>
      <li>マーカー（&lt;&lt;&lt;&lt;&lt;&lt;&lt; など）を削除する </li>
      <li>ファイルを保存する </li>
      <li>git add
      <file>で解決済みにする </li>
      <li>git commit または git merge --continue で処理を完了する </li>
    </ol>
    <p>&nbsp;</p>
	
  </section>
  	
  <p>&nbsp;</p>
  
  <section>
  	<h2> <a name="2._Conflict_解決手順">2. Conflict 解決手順</a></h2>
    <p> github 環境を使って実際に conflict を発生させてみます。</p>
    <p> &nbsp;</p>
    <p> (1)</p>
    <p> サンプルとして下記コードを使用します。このコードが現在 github のリモートリポジトリへ登録されている最新コードと思ってください。</p>
    <pre class="prettyprint linenums lang-cpp" style="width:800px">
// std::jthread サンプル（C++20）
#include &lt;iostream&gt;
#include &lt;thread&gt;
#include &lt;chrono&gt;
#include &lt;stop_token&gt;

int main()
{
    std::cout &lt;&lt; "Main: starting std::jthread demo\n";

    // jthread はデストラクタで自動的に join される
    std::jthread worker([](std::stop_token st){
        int i = 0;
        while (!st.stop_requested()) {
            std::cout &lt;&lt; "worker: tick " &lt;&lt; i++ &lt;&lt; "\n";
            std::this_thread::sleep_for(std::chrono::milliseconds(300));
        }
        std::cout &lt;&lt; "worker: stopping gracefully\n";
    });

    // メインはしばらく待ってから停止を要求する
    std::this_thread::sleep_for(std::chrono::seconds(2));
    std::cout &lt;&lt; "Main: requesting stop\n";
    worker.request_stop();

    // worker のデストラクタで join されるのでここで待つ必要はない
    std::cout &lt;&lt; "Main: exiting (worker will be joined in jthread destructor)\n";

    return EXIT_SUCCESS;
}</pre>
    <p> &nbsp;</p>
    <p> (2) Aさんが steep_for の値を 300 ⇨ 500 へ変更し、commit &amp; push します</p>
    <pre class="prettyprint linenums:16 lang-cpp" style="width:800px">
            std::this_thread::sleep_for(std::chrono::milliseconds(500));</pre>
    <p> &nbsp;</p>
    <p> (3) Bさんが steep_for の値を 300 ⇨ 1000 へ変更し、commit &amp; push します</p>
    <pre class="prettyprint linenums:16 lang-cpp" style="width:800px">
            std::this_thread::sleep_for(std::chrono::milliseconds(1000));</pre>
    <p> &nbsp;</p>
    <p> この Bさん の操作でエラーになりました。vscode の画面だと以下を表示しました。</p>
    
    <figure>
      <img alt="エラー画面 - vscode" src="how_to_resolve_conflicts_in_git/img16.jpg" width="1000">
      <figcaption>エラー画面</figcaption>
    </figure>

    <p> 
    </p>
    <p> &nbsp;</p>
    <p> (4)「コマンド出力を表示する」をクリックすると、下記内容を表示しました。</p>
    
    <pre style="width:800px; background-color: #000000; color: #FFFFFF;">
&gt; git pull --tags origin main
From github.com:kinoshita-hidetoshi/conflict_test
 * branch            main       -&gt; FETCH_HEAD
hint: You have divergent branches and need to specify how to reconcile them.
hint: You can do so by running one of the following commands sometime before
hint: your next pull:
hint:
hint:   git config pull.rebase false  # merge
hint:   git config pull.rebase true   # rebase
hint:   git config pull.ff only       # fast-forward only
hint:
hint: You can replace "git config" with "git config --global" to set a default
hint: preference for all repositories. You can also pass --rebase, --no-rebase,
hint: or --ff-only on the command line to override the configured default per
hint: invocation.
fatal: Need to specify how to reconcile divergent branches.</pre>

    <p> &nbsp;</p>
    <p> 要約すると、<strong>git pull</strong> を失敗している理由は</p>
    <p> 「ローカルとリモートの履歴が分岐していて、Git が “マージするのか 
    / リベースするのか / fast‑forward のみ許可するのか” を判断できないため」</p>
    <p> ということらしいです。</p>
    <p> Git 2.27 以降は、pull 
    のデフォルト動作をユーザーが明示的に設定していない場合、このエラーを出して止まるようになっているそうです。</p>
    <p> &nbsp;</p>
      
    <div class="status_information">
      <div></div>
      <div>
        <p><strong style="font-size: medium">参考</strong></p>
        <p>Git に「どう統合するか」の方針を伝えてあげれば、次回からこの設定に従って自動的に処理されるようになります。コンソールから下記コマンドで設定できます。</p>
        <ol>
          <li>マージで統合したい場合（履歴をそのまま残す）<br><span class="cpp-source">git config 
          pull.rebase false</span></li>
          <li>リベースで統合したい場合（履歴を直線的にしたい）<br><span class="cpp-source">git config 
          pull.rebase true</span></li>
          <li>fast-forward のみ許可（履歴が完全に一致しているときだけ pull）<br>
          <span class="cpp-source">git config pull.ff only</span> </li>
        </ol>
      </div>
    </div>

    <p> &nbsp;</p>
    <p> &nbsp;</p>
    <p> (5) ローカルとリモートが分岐しているので、どれを採用するか決める必要があります。</p>
    <p> よくある選択肢は下記３つです。</p>
    <ol>
      <li>merge</li>
      <li>rebase</li>
      <li>fast-forward</li>
    </ol>
    <p>&nbsp;</p>
    <p>参考に記載の <span class="cpp-source">git config pull.***</span> 
    を設定せず、ここでは手動で解決します。</p>
    <p>vscode の画面上から remote の HEAD を選択して Merge (<span class="cpp-source">Merge into current 
    branch...</span>) します。</p>
    <p> 下図では "Git Graph" というプラグインの画面で紹介していますが、他のツールを使用する場合も同様です。</p>
    
    <figure>
      <img alt="merge" src="how_to_resolve_conflicts_in_git/img21.jpg" width="1000">
      <figcaption>Merge into current branch...</figcaption>
    </figure>
    
    <p> </p>
    <p> &nbsp;</p>
    <p> こんな画面を表示したので、そのまま変更せずに［Yes, merge］をクリックしました。</p>
    <p> 
    <img alt="merge" src="how_to_resolve_conflicts_in_git/img25.jpg" width="600"></p>
    <p> &nbsp;</p>
    <p> ここで Conflict という表示が出ました。 <span class="cpp-source">［Dismiss］</span> をクリックします。</p>
    <p> 
    <img alt="conflict" src="how_to_resolve_conflicts_in_git/img26.jpg" width="600"></p>
    <p> &nbsp;</p>
    <p> ここで最初に説明した conflict の内容を表示しました。</p>
    <p> 
    <img alt="conflict" src="how_to_resolve_conflicts_in_git/img27.jpg" width="1000"></p>
    <p> &nbsp;</p>
    <p> 表示内容は以下の通りです。</p>
    
    <pre class="prettyprint linenums lang-cpp" style="width:800px">
// std::jthread サンプル（C++20）
#include &lt;iostream&gt;
#include &lt;thread&gt;
#include &lt;chrono&gt;
#include &lt;stop_token&gt;

int main()
{
    std::cout &lt;&lt; "Main: starting std::jthread demo\n";

    // jthread はデストラクタで自動的に join される
    std::jthread worker([](std::stop_token st){
        int i = 0;
        while (!st.stop_requested()) {
            std::cout &lt;&lt; "worker: tick " &lt;&lt; i++ &lt;&lt; "\n";
<span class="auto-style1">&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD</span>
<span class="auto-style1">            std::this_thread::sleep_for(std::chrono::milliseconds(1000));</span>
<span class="auto-style1">=======</span>
<span class="auto-style1">            std::this_thread::sleep_for(std::chrono::milliseconds(500));</span>
<span class="auto-style1">&gt;&gt;&gt;&gt;&gt;&gt;&gt; 826b8b9b697e1bef5c095d0c1f1cbf3ae187e3b7</span>
        }
        std::cout &lt;&lt; "worker: stopping gracefully\n";
    });

    // メインはしばらく待ってから停止を要求する
    std::this_thread::sleep_for(std::chrono::seconds(2));
    std::cout &lt;&lt; "Main: requesting stop\n";
    worker.request_stop();

    // worker のデストラクタで join されるのでここで待つ必要はない
    std::cout &lt;&lt; "Main: exiting (worker will be joined in jthread destructor)\n";

    return EXIT_SUCCESS;
}</pre>
    <p> &nbsp;</p>
    <p> (6) Conflict 部分を解決します。</p>
    <p> ここでは下記の通り <span class="cpp-source">std::this_thread::sleep_for(std::chrono::milliseconds(1000));</span> 
    の方を採用します。修正したら保存します。</p>
    <p> vscode 画面上で <span class="cpp-source">［現在の変更を取り込む］</span> をクリックでも良いです。</p>
    
    <pre class="prettyprint linenums lang-cpp" style="width:800px">
// std::jthread サンプル（C++20）
#include &lt;iostream&gt;
#include &lt;thread&gt;
#include &lt;chrono&gt;
#include &lt;stop_token&gt;

int main()
{
    std::cout &lt;&lt; "Main: starting std::jthread demo\n";

    // jthread はデストラクタで自動的に join される
    std::jthread worker([](std::stop_token st){
        int i = 0;
        while (!st.stop_requested()) {
            std::cout &lt;&lt; "worker: tick " &lt;&lt; i++ &lt;&lt; "\n";
            <span class="auto-style1">std::this_thread::sleep_for(std::chrono::milliseconds(1000));</span>
        }
        std::cout &lt;&lt; "worker: stopping gracefully\n";
    });

    // メインはしばらく待ってから停止を要求する
    std::this_thread::sleep_for(std::chrono::seconds(2));
    std::cout &lt;&lt; "Main: requesting stop\n";
    worker.request_stop();

    // worker のデストラクタで join されるのでここで待つ必要はない
    std::cout &lt;&lt; "Main: exiting (worker will be joined in jthread destructor)\n";

    return EXIT_SUCCESS;
}</pre>
    <p> &nbsp;</p>
    <p> (7) 変更を保存後、再度 commit します。</p>
    <p> vscode 画面を見ると、これら操作に伴う変更は２件となっていました。</p>
    <p> 
    <img alt="merge" src="how_to_resolve_conflicts_in_git/img2D.jpg" width="1000"></p>
    <p> &nbsp;</p>
    <p> (8) ［変更の同期 2↑］をクリックします</p>
    <p> &nbsp;</p>
    <p> これで修正結果を git へコミットすることができました。以上で完了です。</p>
    <p> &nbsp;</p>
  </section>
	
  <p> &nbsp;</p>

  <section>
    <h2><a id="ライセンス">ライセンス</a></h2>
    <p>本ページの情報は、特記無い限り下記 MIT ライセンスで提供されます。</p>
    <div class="license">
      The MIT License (MIT)<br><br>
      
      &nbsp; Copyright 2026 Kinoshita Hidetoshi<br><br>
      
      Permission is hereby granted, free of charge, to any person obtaining a copy
      of this software and associated documentation files (the "Software"), to deal
      in the Software without restriction, including without limitation the rights
      to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
      copies of the Software, and to permit persons to whom the Software is
      furnished to do so, subject to the following conditions:<br><br>
      
      The above copyright notice and this permission notice shall be included in all
      copies or substantial portions of the Software.<br><br>
      
      THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
      IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
      FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
      AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
      LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
      OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
      SOFTWARE.
    </div>
    <p>&nbsp;</p>
  </section>
  
  <p> &nbsp;</p>
  
  <section>
  	<h2><a id="参考">参考</a></h2>
  	<ul>
  		<li></li>
  	</ul>
  </section>
  
  <p>&nbsp;</p>
  <hr>
  <p>&nbsp;</p>
  
  <section>
  	<h2 style="margin-bottom:5px">変更履歴</h2>
  	<table>
  	  <tr>
  	    <td class="td_history_date">2026-02-09</td>
  	    <td class="td_history_separator">-</td>
  	    <td class="td_history">新規作成 </td>
  	  </tr>
  	</table>
  </section>
  
  <p>&nbsp;</p>
  
  <section>
    <p><a href="../../index.html" target="_parent">Programming Items トップページ</a></p>
    <p><a href="../../privacy_policy.html">プライバシーポリシー</a></p>
  </section>
  
  <p>&nbsp;</p>
  
  <footer>
  	<p><small>&copy; 2026 Kinoshita Hidetoshi (木下英俊)</small></p>
  </footer>
  
</body>
</html>
