<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="author" content="kinoshita hidetoshi (木下 英俊)">
  <meta name="description" content="木下英俊が自身のためにプログラムメモを残すことを目的に作成したページです。">
  <meta name="keywords" content="">
  <!-- キャッシュ無効化 -->
  <meta http-equiv="Cache-Control" content="no-cache">
	
  <!-- タイトル -->
  <title>[WPF] DataBinding - Counter (C#、WPF) | Programming Items</title>
	
  <!-- ファビコン -->
  <link rel="shortcut icon" href="../../../favicon.ico">
  
  <!-- CSS -->
  <link href="https://unpkg.com/ress/dist/ress.min.css" rel="stylesheet">
	<link rel="stylesheet" href="../../../design.css" type="text/css">
  
	<!-- Start for 'google-code-prettify' -->
	<link href="../../../prettify/styles/desert.css" rel="stylesheet" type="text/css">
	<script src="../../../prettify/prettify.js" type="text/javascript"></script>
	<!-- End for 'google-code-prettify' -->	
	
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-V2DZQK54C2"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'G-V2DZQK54C2');
  </script>
  <!-- Global site tag (gtag.js) - Google Analytics -->

  <style type="text/css">
    .auto-style8 {
    	border-collapse: collapse;
    	text-align: justify;
    	font-size: 10.0pt;
    	font-family: Century;
    	border: 1.0pt solid windowtext;
    }
    .auto-style9 {
    	background-color: #505000;
    }
  </style>

</head>

<body onload="prettyPrint();">
<h1>Counter (C#、WPF)</h1>

<p>職場の若手向けお勉強テーマとして作成しました。C#(WPF) で下記の機能を実現しなさい、という内容です。<br>
カウンタ表示部と、内部変数、をデータバインディングします。</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<div class="mokuji">
  <nav>
	<h2>目次</h2>
	<p><a href="#1.要求仕様">1. 要求仕様</a></p>
	<p>&nbsp; <a href="#1.1.機能">1.1. 機能</a></p>
	<p>&nbsp; <a href="#1.2._画面仕様">1.2. 画面仕様</a></p>
	<p>&nbsp; <a href="#1.3.実装仕様（C）">1.3. 実装仕様</a></p>
	<p>&nbsp; <a href="#1.4.動作環境、開発環境">1.4. 動作環境、開発環境</a></p>
	<p><a href="#2._実装例（その１）：_TextBox_をモデルに結び付ける">2. 実装例（その１）： TextBox をモデルに結び付ける</a></p>
	<p><a href="#3._実装例（その２）：Buttonをコマンドに結び付ける">3. 実装例（その２）： Button をコマンドに結び付ける</a></p>
	<p>&nbsp; <a href="#3.1._Counter.dll">3.1. Counter.dll</a></p>
	<p>&nbsp; <a href="#3.2._CounterWPF.exe">3.2. CounterWPF.exe</a></p>
	<p>&nbsp;&nbsp; <a href="#3.2.1._MainWindow.xaml.cs">3.2.1. MainWindow.xaml.cs</a></p>
	<p>&nbsp;&nbsp; <a href="#3.2.2._Window_の_DataContext_に_Counter_を新規登録">3.2.2. Window の DataContext に Counter を新規登録</a></p>
	<p>&nbsp;&nbsp; <a href="#3.2.3._TextBox_の_Text_を_DataContext_の_Counter.CountValue_へバインディング">3.2.3. TextBox の Text を DataContext の Counter.CountValue へバインディング</a></p>
	<p>&nbsp;&nbsp; <a href="#3.2.4._「＋」ボタンのコマンドを_Counter.IncrementCommand_へバインディング">3.2.4. 「＋」ボタンのコマンドを Counter.IncrementCommand へバインディング</a></p>
	<p>&nbsp;&nbsp; <a href="#3.2.5._「－」、「Clear」ボタンのコマンドをバインディング">3.2.5. 「－」、「Clear」ボタンのコマンドをバインディング</a></p>
	<p>&nbsp;</p>
	<p><a href="#ライセンス">ライセンス</a></p>
	<p><a href="#参考">参考</a></p>
  </nav>
</div>

<p>&nbsp;</p>
<p>&nbsp;</p>

<h2><a name="1.要求仕様">1. 要求仕様</a></h2>

<h3><a name="1.1.機能">1.1. 機能</a></h3>
<ul>
	<li>アプリケーションはカウンタの値を表示する機能を持つ。</li>
	<li>アプリケーション起動時のカウンタ初期値を０とする。</li>
	<li>ボタンAを押すと、カウンタの値を１加算する。</li>
	<li>ボタンBを押すと、カウンタの値を1減算する。</li>
	<li>ボタンCを押すと、カウンタの値を０にクリアする。</li>
	<li>
	ボタンDを押すと、終了確認ダイアログを表示し、はい(またはYes)を押下したらアプリケーションを終了する。いいえ（またはNo）を押下した場合はアプリケーションを終了せずに動作を継続する。</li>
	<li>カウンタの値範囲を０～１０とする。</li>
	<li>カウンタが0のとき、”-”ボタンを無効化すること。</li>
	<li>カウンタが 10 のとき、”+”ボタンを無効化すること。</li>
</ul>

<p>&nbsp;</p>

<h3><a name="1.2._画面仕様">1.2. 画面仕様</h3>

<p>画面仕様は以下の通り。記載事項以外は自由に設計のこと。</p>
<ul>
  <li>
    <p>フォント： 	Arial</p>
  </li>
</ul>

<p><img alt="画面仕様" height="348" src="Counter/clip_image001.gif" width="564"></p>

<p>
<table border="1" cellpadding="0" cellspacing="0" class="auto-style8" style="mso-border-alt: solid windowtext .5pt; mso-yfti-tbllook: 480; mso-padding-alt: 0mm 5.4pt 0mm 5.4pt; mso-border-insideh: .5pt solid windowtext; mso-border-insidev: .5pt solid windowtext; text-justify: inter-ideograph;">
	<tr style="mso-yfti-irow: 0; mso-yfti-firstrow: yes">
		<td style="width: 32.4pt; border: solid windowtext 1.0pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt" width="54">
		<p class="MsoNormal"><span style="font-family: &quot;Meiryo UI&quot;">項番<span lang="EN-US"><o:p></o:p></span></span></p>
		</td>
		<td style="width: 90.0pt; border: solid windowtext 1.0pt; border-left: none; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt" width="150">
		<p class="MsoNormal"><span style="font-family: &quot;Meiryo UI&quot;">概要<span lang="EN-US"><o:p></o:p></span></span></p>
		</td>
		<td style="width: 51.3pt; border: solid windowtext 1.0pt; border-left: none; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt" width="86">
		<p class="MsoNormal"><span style="font-family: &quot;Meiryo UI&quot;">
		ｺﾝﾄﾛｰﾙ<span lang="EN-US"><o:p></o:p></span></span></p>
		</td>
		<td style="border-right: 1.0pt solid windowtext; border-top: 1.0pt solid windowtext; border-bottom: 1.0pt solid windowtext; width: 52pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; border-left-style: none; border-left-color: inherit; border-left-width: medium;">
		<p class="MsoNormal"><span style="font-family: &quot;Meiryo UI&quot;">
		ﾀﾌﾞ<o:p>ｵｰﾀﾞｰ</o:p></span></p>
		</td>
		<td style="border-right: 1.0pt solid windowtext; border-top: 1.0pt solid windowtext; border-bottom: 1.0pt solid windowtext; width: 148pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; border-left-style: none; border-left-color: inherit; border-left-width: medium;">
		<p class="MsoNormal"><span style="font-family: &quot;Meiryo UI&quot;">
		文字列、文字種別、他<span lang="EN-US"><o:p></o:p></span></span></p>
		</td>
		<td style="border-right: 1.0pt solid windowtext; border-top: 1.0pt solid windowtext; border-bottom: 1.0pt solid windowtext; width: 171pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; border-left-style: none; border-left-color: inherit; border-left-width: medium;">
		<p class="MsoNormal"><span style="font-family: &quot;Meiryo UI&quot;">他<span lang="EN-US"><o:p></o:p></span></span></p>
		</td>
	</tr>
	<tr style="mso-yfti-irow: 1">
		<td style="width: 32.4pt; border: solid windowtext 1.0pt; border-top: none; mso-border-top-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt" valign="top" width="54">
		<p class="MsoNormal">
		①</p>
		</td>
		<td style="width: 90.0pt; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt" valign="top" width="150">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;"><o:p>&nbsp;</o:p></span></p>
		</td>
		<td style="width: 51.3pt; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt" valign="top" width="86">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">-<o:p></o:p></span></p>
		</td>
		<td style="width: 52pt; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;"><o:p>&nbsp;</o:p></span></p>
		</td>
		<td style="width: 148pt; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">“Counter”<o:p></o:p></span></p>
		</td>
		<td style="width: 171pt; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">Window</span><span style="font-family: &quot;Meiryo UI&quot;">サイズ：<span lang="EN-US">800</span>×<span lang="EN-US">600</span>以内<span lang="EN-US"><o:p></o:p></span></span></p>
		</td>
	</tr>
	<tr style="mso-yfti-irow: 2">
		<td style="width: 32.4pt; border: solid windowtext 1.0pt; border-top: none; mso-border-top-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt" valign="top" width="54">
		<p class="MsoNormal">
		②</p>
		</td>
		<td style="width: 90.0pt; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt" valign="top" width="150">
		<p class="MsoNormal"><span style="font-family: &quot;Meiryo UI&quot;">
		値表示部<span lang="EN-US"><o:p></o:p></span></span></p>
		</td>
		<td style="width: 51.3pt; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt" valign="top" width="86">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">TextBox<o:p></o:p></span></p>
		</td>
		<td style="width: 52pt; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">(*1)<o:p></o:p></span></p>
		</td>
		<td style="width: 148pt; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">Number,
		</span><span style="font-family: &quot;Meiryo UI&quot;">値範囲<span lang="EN-US">:0</span>～<span lang="EN-US">10<o:p></o:p></span></span></p>
		</td>
		<td style="width: 171pt; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top">
		<p class="MsoNormal"><span style="font-family: &quot;Meiryo UI&quot;">
		フォントサイズ：<span lang="EN-US">36pt<o:p></o:p></span></span></p>
		<p class="MsoNormal"><span style="font-family: &quot;Meiryo UI&quot;">
		センター表示<span lang="EN-US"><o:p></o:p></span></span></p>
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">ReadOnly<o:p></o:p></span></p>
		</td>
	</tr>
	<tr style="mso-yfti-irow: 3">
		<td style="width: 32.4pt; border: solid windowtext 1.0pt; border-top: none; mso-border-top-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt" valign="top" width="54">
		<p class="MsoNormal">
		③</p>
		</td>
		<td style="width: 90.0pt; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt" valign="top" width="150">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">+1<o:p></o:p></span></p>
		</td>
		<td style="width: 51.3pt; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt" valign="top" width="86">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">Button<o:p></o:p></span></p>
		</td>
		<td style="width: 52pt; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">1<o:p></o:p></span></p>
		</td>
		<td style="width: 148pt; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">“+”<o:p></o:p></span></p>
		</td>
		<td style="width: 171pt; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top">
		<p class="MsoNormal"><span style="font-family: &quot;Meiryo UI&quot;">
		フォントサイズ：<span lang="EN-US">12pt<o:p></o:p></span></span></p>
		</td>
	</tr>
	<tr style="mso-yfti-irow: 4">
		<td style="width: 32.4pt; border: solid windowtext 1.0pt; border-top: none; mso-border-top-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt" valign="top" width="54">
		<p class="MsoNormal">
		④</p>
		</td>
		<td style="width: 90.0pt; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt" valign="top" width="150">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">-1<o:p></o:p></span></p>
		</td>
		<td style="width: 51.3pt; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt" valign="top" width="86">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">Button<o:p></o:p></span></p>
		</td>
		<td style="width: 52pt; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">2<o:p></o:p></span></p>
		</td>
		<td style="width: 148pt; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">“-“<o:p></o:p></span></p>
		</td>
		<td style="width: 171pt; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top">
		<p class="MsoNormal"><span style="font-family: &quot;Meiryo UI&quot;">
		フォントサイズ：<span lang="EN-US">12pt<o:p></o:p></span></span></p>
		</td>
	</tr>
	<tr style="mso-yfti-irow: 5">
		<td style="width: 32.4pt; border: solid windowtext 1.0pt; border-top: none; mso-border-top-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt" valign="top" width="54">
		<p class="MsoNormal">
		⑤</p>
		</td>
		<td style="width: 90.0pt; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt" valign="top" width="150">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">0</span><span style="font-family: &quot;Meiryo UI&quot;">クリア<span lang="EN-US"><o:p></o:p></span></span></p>
		</td>
		<td style="width: 51.3pt; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt" valign="top" width="86">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">Button<o:p></o:p></span></p>
		</td>
		<td style="width: 52pt; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">3<o:p></o:p></span></p>
		</td>
		<td style="width: 148pt; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">“Clear”<o:p></o:p></span></p>
		</td>
		<td style="width: 171pt; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top">
		<p class="MsoNormal"><span style="font-family: &quot;Meiryo UI&quot;">
		フォントサイズ：<span lang="EN-US">12pt<o:p></o:p></span></span></p>
		</td>
	</tr>
	<tr style="mso-yfti-irow: 6; mso-yfti-lastrow: yes">
		<td style="border-left: 1.0pt solid windowtext; border-right: 1.0pt solid windowtext; border-bottom: 1.0pt solid windowtext; width: 32.4pt; mso-border-top-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; height: 69px; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top" width="54">
		<p class="MsoNormal">
		⑥</p>
		</td>
		<td style="width: 90.0pt; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; height: 69px; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top" width="150">
		<p class="MsoNormal"><span style="font-family: &quot;Meiryo UI&quot;">
		プログラム<span lang="EN-US"><o:p></o:p></span></span></p>
		<p class="MsoNormal"><span style="font-family: &quot;Meiryo UI&quot;">
		終了ボタン<span lang="EN-US"><o:p></o:p></span></span></p>
		</td>
		<td style="width: 51.3pt; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; height: 69px; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top" width="86">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">Button<o:p></o:p></span></p>
		</td>
		<td style="width: 52pt; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; height: 69px; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">0<o:p></o:p></span></p>
		</td>
		<td style="width: 148pt; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; height: 69px; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">“Quit”<o:p></o:p></span></p>
		</td>
		<td style="width: 171pt; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; height: 69px; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top">
		<p class="MsoNormal"><span style="font-family: &quot;Meiryo UI&quot;">
		フォントサイズ：<span lang="EN-US">12pt<o:p></o:p></span></span></p>
		</td>
	</tr>
</table>
</p>

<p>(*1) TabStop を False に設定</p>

<p>&nbsp;</p>

<h3><a name="1.3.実装仕様（C）">1.3.実装仕様（C#）</a></h3>

<ul>
	<li>アプリケーション内部に画面表示と独立のカウンタクラス<span lang="EN-US">( class Counter )</span>を持つこと。</li>
	<li><span lang="EN-US" style="font-family:&quot;Meiryo UI&quot;">class Counter
</span>は単独のクラスライブラリとして作成し、<span lang="EN-US">DLL</span>として作成のこと。</li>
	<li><span lang="EN-US" style="font-family:&quot;Meiryo UI&quot;">class Counter
</span>は パブリックメソッドとして、<span lang="EN-US">(1) Increment, (2) Decrement, (3) Clear
</span>を持つこと。</li>
	<li><span lang="EN-US" style="font-family:&quot;Meiryo UI&quot;">class Counter
</span>はパブリックプロパティとしてカウンタの値を示す <span lang="EN-US">countValue </span>を持つこと。</li>
	<li><span lang="EN-US" style="font-family:&quot;Meiryo UI&quot;">class Counter
</span>は値範囲の上限値<span lang="EN-US">(10)</span>、下限値<span lang="EN-US">(0)</span>、を示すパブリックメンバ変数を持つこと。</li>
	<li>表示部の値<span lang="EN-US">(</span>①<span lang="EN-US">)</span>と、前述のcountValueはデータバインディングにより接続し、表示部の値<span lang="EN-US">(</span>①<span lang="EN-US">)</span>をプログラムにより表示変更する実装を行わないこと。（ヒント：<span lang="EN-US">INotyfiyPropertyChanged</span>）<span lang="EN-US"><o:p></o:p></span></li>
</ul>
<p>&nbsp;</p>

<h3><a name="1.4.動作環境、開発環境">1.4.動作環境、開発環境</a></h3>

<p>
動作環境： Windows XP または Windows7<br>
開発環境： Visual Studio 2008 以降<br>
開発言語： C#(WPF)</p>

<p>&nbsp;</p>
<p>&nbsp;</p>

<h2><a name="2._実装例（その１）：_TextBox_をモデルに結び付ける">2. 実装例（その１）： TextBox をモデルに結び付ける</a></h2>

<p>実際に私が作成したプログラムの画面は下図の通り。<br>TextBoxの部分だけ 色づけ 
を遊んでみました。パネルが曲面を描いているように見えれば幸いです。<br>実作業は Expression Blend 
で行いました。Blendが無いとWPFの実装は面白くないですね。</p>
<p><img alt="作成したプログラム画面" height="309" src="Counter/Counter_WPF.png" width="446"></p>
<p> &nbsp;</p>
<p> WPF では、XAMLとC#コード間のデータバインディングを行うために &quot;DataContext&quot; というメンバ変数を介して行うようです。</p>
<p> <span class="table_title">[プログラムソース (Window1.xaml)]</span></p>

<pre class="prettyprint linenums">
&lt;Window
  xmlns=&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;
  xmlns:x=&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;
  xmlns:d=&quot;http://schemas.microsoft.com/expression/blend/2008&quot; 
  xmlns:mc=&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot; mc:Ignorable=&quot;d&quot;
  xmlns:CounterDll=&quot;clr-namespace:CounterDll;assembly=CounterDll&quot; x:Class=&quot;CounterWPF.Window1&quot;
  Title=&quot;Counter on the WPF&quot; Height=&quot;237.333&quot; Width=&quot;347.467&quot;
  ResizeMode=&quot;NoResize&quot; Background=&quot;White&quot; Closing=&quot;Window_Closing&quot;&gt;

  &lt;Grid&gt;
    &lt;Button x:Name=&quot;Button_Quit&quot; HorizontalAlignment=&quot;Right&quot; Margin=&quot;8,0,8,8&quot; Width=&quot;100&quot;
      Content=&quot;Quit&quot; VerticalAlignment=&quot;Bottom&quot; Height=&quot;50&quot; FontFamily=&quot;Arial&quot; FontSize=&quot;16&quot;
      Click=&quot;Button_Click_Quit&quot; ToolTip=&quot;プログラムを終了します。&quot; /&gt;

    &lt;TextBox x:Name=&quot;TextBox_CounterView&quot; Margin=&quot;8,8,8,0&quot; VerticalAlignment=&quot;Top&quot; Height=&quot;59&quot;
      TextWrapping=&quot;Wrap&quot; FontFamily=&quot;Arial&quot; FontSize=&quot;48&quot; TextAlignment=&quot;Center&quot;
      <span class="auto-style9">Text=&quot;{Binding Path=counter.CountValue, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}&quot;</span> 
      IsReadOnly=&quot;True&quot; IsTabStop=&quot;False&quot; ToolTip=&quot;値を表示します。&quot;&gt;
      &lt;TextBox.Background&gt;
        &lt;LinearGradientBrush EndPoint=&quot;0.496,0.022&quot; StartPoint=&quot;0.498,0.936&quot;&gt;
          &lt;GradientStop Color=&quot;#FF8392AD&quot; Offset=&quot;0.004&quot;/&gt;
          &lt;GradientStop Color=&quot;#FFE2E5EA&quot; Offset=&quot;1&quot;/&gt;
        &lt;/LinearGradientBrush&gt;
      &lt;/TextBox.Background&gt;
      &lt;TextBox.Effect&gt;
        &lt;DropShadowEffect Direction=&quot;135&quot; ShadowDepth=&quot;2&quot;/&gt;
      &lt;/TextBox.Effect&gt;
    &lt;/TextBox&gt;

    &lt;Button x:Name=&quot;Button_Increment&quot; HorizontalAlignment=&quot;Left&quot; Margin=&quot;8,80,0,0&quot; Width=&quot;100&quot;
      Content=&quot;+&quot; FontFamily=&quot;Arial&quot; FontSize=&quot;16&quot; Click=&quot;Button_Click_Increment&quot; 
      ToolTip=&quot;値を１つ加算します。&quot; Height=&quot;50&quot; VerticalAlignment=&quot;Top&quot; /&gt;
    &lt;Button x:Name=&quot;Button_Decrement&quot; Margin=&quot;0,80,0,0&quot; Content=&quot;-&quot; FontFamily=&quot;Arial&quot; FontSize=&quot;16&quot;
      Click=&quot;Button_Click_Decrement&quot; ToolTip=&quot;値を１つ減算します。&quot; Width=&quot;100&quot; 
      HorizontalAlignment=&quot;Center&quot; VerticalAlignment=&quot;Top&quot; Height=&quot;50&quot; /&gt;
    &lt;Button x:Name=&quot;Button_Clear&quot; Margin=&quot;0,80,8,0&quot; Content=&quot;Clear&quot; HorizontalAlignment=&quot;Right&quot;
      Width=&quot;100&quot; FontFamily=&quot;Arial&quot; FontSize=&quot;16&quot; Click=&quot;Button_Click_Clear&quot; 
      ToolTip=&quot;値を０にクリアします。&quot; Height=&quot;50&quot; VerticalAlignment=&quot;Top&quot; /&gt;
    &lt;Rectangle Fill=&quot;White&quot; Margin=&quot;8,14.6,8,0&quot; VerticalAlignment=&quot;Top&quot; Height=&quot;13.6&quot; Opacity=&quot;0.85&quot;&gt;
      &lt;Rectangle.Effect&gt;
        &lt;BlurEffect Radius=&quot;10&quot;/&gt;
      &lt;/Rectangle.Effect&gt;
    &lt;/Rectangle&gt;
  &lt;/Grid&gt;
&lt;/Window&gt;
</pre>

<p>&nbsp;</p>
<p><span class="table_title">[プログラムソース (Window1.xaml.cs)]</span></p>

<pre class="prettyprint linenums">
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;

using CounterDll;


namespace CounterWPF
{
<span class="comment">    /// &lt;summary&gt;
    /// Window1.xaml の相互作用ロジック
    /// &lt;/summary&gt;</span>
    public partial class Window1 : Window
    {
        private Counter _counter = new Counter();


        public Window1()
        {
            InitializeComponent();
<span class="auto-style9">//          DataContext = _counter;</span>
<span class="auto-style9">            DataContext = new</span>
<span class="auto-style9">            {</span>
<span class="auto-style9">                counter = _counter,</span>
<span class="auto-style9">            };</span>
            Button_Click_Clear(this, new RoutedEventArgs());
        }

        private void Button_Click_Quit(object sender, System.Windows.RoutedEventArgs e)
        {
            <span class="comment">// TODO: ここにイベント ハンドラーのコードを追加します。</span>
            Close();
        }

        private void Button_Click_Increment(object sender, System.Windows.RoutedEventArgs e)
        {
            _counter.Increment();

            if (_counter.CountValue == _counter.CountMax)
            {
                Button_Increment.IsEnabled = false;
            }
            if (_counter.CountValue != _counter.CountMin)
            {
                Button_Decrement.IsEnabled = true;
            }
        }

        private void Button_Click_Decrement(object sender, System.Windows.RoutedEventArgs e)
        {
            _counter.Decrement();

            if (_counter.CountValue != _counter.CountMax)
            {
                Button_Increment.IsEnabled = true;
            }
            if (_counter.CountValue == _counter.CountMin)
            {
                Button_Decrement.IsEnabled = false;
            }
        }

        private void Button_Click_Clear(object sender, System.Windows.RoutedEventArgs e)
        {
            _counter.Clear();
            Button_Increment.IsEnabled = true;
            Button_Decrement.IsEnabled = false;
        }

        private void Window_Closing(object sender, System.ComponentModel.CancelEventArgs e)
        {
            if (MessageBox.Show(<span class="string">&quot;プログラムを終了してよろしいですか？&quot;</span>, <span class="string">&quot;終了確認&quot;</span>,
                  MessageBoxButton.YesNo, MessageBoxImage.Question) == MessageBoxResult.Yes)
            {
                <span class="comment">// プログラムを終了する</span>
            }
            else
            {
                <span class="comment">// プログラムを終了しない</span>
                e.Cancel = true;
            }
        }
    }
}
</pre>

<p> &nbsp;</p>
<p> <span class="table_title">[プログラムソース (Counter.cs)]</span></p>

<pre class="prettyprint linenums">
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

<span class="auto-style9">using System.ComponentModel;</span> // INotifyPropertyChanged


[assembly: CLSCompliant(true)]  // CA1014
namespace CounterDll
{
    public class Counter : <span class="auto-style9">INotifyPropertyChanged</span>
    {

        private int _countValue ;
        public int CountValue
        {
            get
            {
                return _countValue;
            }
            set
            {
                _countValue = value;
                NotifyPropertyChanged(&quot;CountValue&quot;);
            }
        }

        private readonly int _CountMax = 10;
        public int CountMax
        {
            get
            {
                return _CountMax;
            }
        }

        private readonly int _CountMin = 0;
        public int CountMin
        {
            get
            {
                return _CountMin;
            }
        }
    
        public void Increment()
        {
            if (_countValue &lt; _CountMax)
            {
                CountValue++;
            }
        }

        public void Decrement()
        {
            if (_countValue &gt; _CountMin)
            {
                CountValue--;
            }
        }

        public void Clear()
        {
            CountValue = 0;
        }


<span class="auto-style9">        #region INotifyPropertyChanged</span>

<span class="auto-style9">        public event PropertyChangedEventHandler PropertyChanged;</span>

<span class="auto-style9">        void NotifyPropertyChanged(string info)</span>
<span class="auto-style9">        {</span>
<span class="auto-style9">            if (PropertyChanged != null)</span>
<span class="auto-style9">            {</span>
<span class="auto-style9">                PropertyChanged(this, new PropertyChangedEventArgs(info));</span>
<span class="auto-style9">            }</span>
<span class="auto-style9">        }</span>

<span class="auto-style9">        #endregion // INotifyPropertyChanged</span>

    }
}
</pre>

<p> <a href="Counter/Counter_WPF.zip">サンプルプログラム ダウンロード</a></p>
<p> &nbsp;</p>
<p> &nbsp;</p>

<h2><a name="3._実装例（その２）：Buttonをコマンドに結び付ける">3. 実装例（その２）： Button をコマンドに結び付ける</a></h2>

<p>BUTTON のコマンドをモデル部に結び付けます。<br>
ここでは（その１）からの改造ではなくて新規作成のイメージで進めます。理由は、この手順で進めた場合にはコントロールへのデータ・バインディングがVSからGUIで実施しやすくなることを示すためです。<br>以下にプログラムを記載します。</p>
<p>&nbsp;</p>

<h3><a name="3.1._Counter.dll">3.1. Counter.dll</a></h3>

<p>class Counter をDLLとして作成します。<br>DLLでなくても動作するはずです。</p>
<p>[&quot;Counter.cs&quot;]</p>

<pre class="prettyprint linenums">
using System;

[assembly: CLSCompliant(true)]  // CA1014
namespace CounterDll
{
    public class Counter : ViewModel
    {
<span class="auto-style9">        #region ICommands</span>
<span class="auto-style9">        // +ボタンで呼ばれるコマンド</span>
<span class="auto-style9">        public DelegateCommand IncrementCommand { get; private set; }</span>

<span class="auto-style9">        // -ボタンで呼ばれるコマンド</span>
<span class="auto-style9">        public DelegateCommand DecrementCommand { get; private set; }</span>

<span class="auto-style9">        // Clearボタンで呼ばれるコマンド</span>
<span class="auto-style9">        public DelegateCommand ClearCommand { get; private set; }</span>
<span class="auto-style9">        #endregion ICommand</span>


        #region countValue
        private int _countValue ;
        public int CountValue
        {
            get
            {
                return _countValue;
            }
            set
            {
                _countValue = value;
                NotifyPropertyChanged(&quot;CountValue&quot;);
<span class="auto-style9">                IncrementCommand.NotifyCanExcuteChanged();</span>
<span class="auto-style9">                DecrementCommand.NotifyCanExcuteChanged();</span>
            }
        }

        private readonly int _CountMax = 10;
        public int CountMax
        {
            get
            {
                return _CountMax;
            }
        }

        private readonly int _CountMin = 0;
        public int CountMin
        {
            get
            {
                return _CountMin;
            }
        }
        #endregion countValue


        /// &lt;summary&gt;
        /// コンストラクタ
        /// &lt;/summary&gt;
        public Counter()
        {
<span class="auto-style9">            // + コマンドを実装</span>
<span class="auto-style9">            IncrementCommand = new DelegateCommand(</span>
<span class="auto-style9">                () =&gt; {</span>
<span class="auto-style9">                    Increment();</span>
<span class="auto-style9">                },</span>
<span class="auto-style9">                () =&gt;</span>
<span class="auto-style9">                {</span>
<span class="auto-style9">                    bool bCanExecute = true;</span>

<span class="auto-style9">                    if ( CountValue &gt;= CountMax)</span>
<span class="auto-style9">                    {</span>
<span class="auto-style9">                        bCanExecute = false;</span>
<span class="auto-style9">                    }</span>

<span class="auto-style9">                    return bCanExecute;</span>
<span class="auto-style9">                });</span>

<span class="auto-style9">            // - コマンドを実装</span>
<span class="auto-style9">            DecrementCommand = new DelegateCommand(</span>
<span class="auto-style9">                () =&gt; {</span>
<span class="auto-style9">                    Decrement();</span>
<span class="auto-style9">                },</span>
<span class="auto-style9">                () =&gt;</span>
<span class="auto-style9">                {</span>
<span class="auto-style9">                    bool bCanExecute = true;</span>

<span class="auto-style9">                    if (CountValue &lt;= CountMin)</span>
<span class="auto-style9">                    {</span>
<span class="auto-style9">                        bCanExecute = false;</span>
<span class="auto-style9">                    }</span>

<span class="auto-style9">                    return bCanExecute;</span>
<span class="auto-style9">                });</span>

<span class="auto-style9">            // Clear コマンドを実装</span>
<span class="auto-style9">            ClearCommand = new DelegateCommand(</span>
<span class="auto-style9">                () =&gt;</span>
<span class="auto-style9">                {</span>
<span class="auto-style9">                    Clear();</span>
<span class="auto-style9">                });</span>
        }

        private void Increment()
        {
            if (_countValue &lt; _CountMax)
            {
                CountValue++;
            }
        }

        private void Decrement()
        {
            if (_countValue &gt; _CountMin)
            {
                CountValue--;
            }
        }

        private void Clear()
        {
            CountValue = 0;
        }
    }
}</pre>

<p> &nbsp;</p>
<p> [ViewModel.cs]</p>

<pre class="prettyprint linenums">
<span class="auto-style9">using System.ComponentModel;            // INotifyPropertyChanged</span>
<span class="auto-style9">using System.Runtime.CompilerServices;  // CallerMemberName</span>

namespace CounterDll
{
<span class="auto-style9">    public class ViewModel : INotifyPropertyChanged</span>
<span class="auto-style9">    {</span>
<span class="auto-style9">        public event PropertyChangedEventHandler PropertyChanged;</span>
<span class="auto-style9">        protected virtual void NotifyPropertyChanged([CallerMemberName] string propertyName = null)</span>
<span class="auto-style9">        {</span>
<span class="auto-style9">            if (this.PropertyChanged != null)</span>
<span class="auto-style9">            {</span>
<span class="auto-style9">                this.PropertyChanged(this, new PropertyChangedEventArgs(propertyName));</span>
<span class="auto-style9">            }</span>
<span class="auto-style9">        }</span>
<span class="auto-style9">    }</span>
}</pre>

<p>&nbsp;</p>
<p>[DelegateCommand.cs]</p>

<pre class="prettyprint linenums">
using System;
<span class="auto-style9">using System.Windows.Input;             // ICommand</span>

namespace CounterDll
{

<span class="auto-style9">    public class DelegateCommand : ICommand</span>
<span class="auto-style9">    {</span>
<span class="auto-style9">        private readonly Action _execute;</span>
<span class="auto-style9">        private readonly Func&lt;bool&gt; _canExecute;</span>

<span class="auto-style9">        public DelegateCommand(Action execute)</span>
<span class="auto-style9">            : this(execute, () =&gt; true)</span>
<span class="auto-style9">        { }</span>

<span class="auto-style9">        public DelegateCommand(Action execute, Func&lt;bool&gt; canExecute)</span>
<span class="auto-style9">        {</span>
<span class="auto-style9">            this._execute = execute;</span>
<span class="auto-style9">            this._canExecute = canExecute;</span>
<span class="auto-style9">        }</span>

<span class="auto-style9">        public void Execute(object parameter)</span>
<span class="auto-style9">        {</span>
<span class="auto-style9">            this._execute();</span>
<span class="auto-style9">        }</span>

<span class="auto-style9">        public bool CanExecute(object parameter)</span>
<span class="auto-style9">        {</span>
<span class="auto-style9">            return this._canExecute();</span>
<span class="auto-style9">        }</span>

<span class="auto-style9">        public event EventHandler CanExecuteChanged;</span>
<span class="auto-style9">        public void NotifyCanExcuteChanged()</span>
<span class="auto-style9">        {</span>
<span class="auto-style9">            if (CanExecuteChanged != null)</span>
<span class="auto-style9">            {</span>
<span class="auto-style9">                CanExecuteChanged(this, EventArgs.Empty);</span>
<span class="auto-style9">            }</span>
<span class="auto-style9">        }</span>
<span class="auto-style9">    }</span>
}</pre>

<p> &nbsp;</p>
<p> &nbsp;</p>
<h3> <a name="3.2._CounterWPF.exe">3.2. CounterWPF.exe</a></h3>
<p> では本体アプリ側を修正します。<br>先ほど作成した Counter.dll を参照設定しておくのを忘れずに。</p>
<p> &nbsp;</p>
<h4> <a name="3.2.1._MainWindow.xaml.cs">3.2.1. MainWindow.xaml.cs</a></h4>
<p> MainWindow.xaml.cs です。こちら、ほとんど空っぽになりました。</p>
<p> [MainWindow.xaml.cs]</p>

<pre class="prettyprint linenums">
using System.Windows;

namespace CounterWPF
{
    public partial class Window1 : Window
    {
        public Window1()
        {
            InitializeComponent();
        }

        private void Button_Click_Quit(object sender, System.Windows.RoutedEventArgs e)
        {
            Close();
        }

        private void Window_Closing(object sender, System.ComponentModel.CancelEventArgs e)
        {
            if (MessageBox.Show(&quot;プログラムを終了してよろしいですか？&quot;, &quot;終了確認&quot;,
                MessageBoxButton.YesNo, MessageBoxImage.Question) == MessageBoxResult.Yes)
            {
                // プログラムを終了する
            }
            else
            {
                // プログラムを終了しない
                e.Cancel = true;
            }
        }
    }
}</pre>

<p>&nbsp;</p>
<p>&nbsp;</p>

<h4><a name="3.2.2._Window_の_DataContext_に_Counter_を新規登録">3.2.2. Window の DataContext に Counter を新規登録</a></h4>

<p>Window の DataContext へ Counter を新規登録します。<br>Window を選択後、DataContext 
の右側にある「新規作成」ボタンをクリックしてください。 </p>
<p><img alt="Visual Studio 画面（１）" height="573" src="Counter/img1E.jpg" width="1066"></p>
<p><img alt="Visual Studio 画面（２）" src="Counter/img1F.jpg"></p>
<p>&nbsp;</p>
<p>「オブジェクトの選択」画面を表示するので、ここから CounterDll から class Counter を選択後、「OK」ボタンをクリックします。</p>
<p><img alt="Visual Studio 画面（３）" src="Counter/img23.jpg"></p>
<p>&nbsp;</p>
<p>これで Window の DataContext へ Counter を登録することができました。</p>
<p>この時点の MainWindow.xaml.cs は以下の通りです。&nbsp;</p>
<p>&nbsp;</p>

<pre class="prettyprint linenums">
&lt;Window
    xmlns=&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;
    xmlns:x=&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;
    xmlns:d=&quot;http://schemas.microsoft.com/expression/blend/2008&quot; 
    xmlns:mc=&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot; mc:Ignorable=&quot;d&quot; 
    xmlns:CounterDll=&quot;clr-namespace:CounterDll;assembly=CounterDll&quot; x:Class=&quot;CounterWPF.Window1&quot;
    Title=&quot;Counter on the WPF&quot; Height=&quot;237.333&quot; Width=&quot;347.467&quot; ResizeMode=&quot;NoResize&quot;
    Background=&quot;White&quot; Closing=&quot;Window_Closing&quot;&gt;

<span class="auto-style9">    &lt;Window.DataContext&gt;</span>
<span class="auto-style9">        &lt;CounterDll:Counter/&gt;</span>
<span class="auto-style9">    &lt;/Window.DataContext&gt;</span>
    &lt;Grid&gt;
        &lt;Button x:Name=&quot;Button_Quit&quot; HorizontalAlignment=&quot;Right&quot; Margin=&quot;8,0,8,8&quot; Width=&quot;100&quot; 
            Content=&quot;Quit&quot; VerticalAlignment=&quot;Bottom&quot; Height=&quot;50&quot; FontFamily=&quot;Arial&quot; FontSize=&quot;16&quot; 
            Click=&quot;Button_Click_Quit&quot; ToolTip=&quot;プログラムを終了します。&quot; /&gt;

        &lt;TextBox x:Name=&quot;TextBox_CounterView&quot; Margin=&quot;8,8,8,0&quot; VerticalAlignment=&quot;Top&quot; Height=&quot;59&quot;
            TextWrapping=&quot;Wrap&quot; FontFamily=&quot;Arial&quot; FontSize=&quot;48&quot; TextAlignment=&quot;Center&quot; IsReadOnly=&quot;True&quot;
            IsTabStop=&quot;False&quot; ToolTip=&quot;値を表示します。&quot;&gt;

            &lt;TextBox.Background&gt;
                &lt;LinearGradientBrush EndPoint=&quot;0.496,0.022&quot; StartPoint=&quot;0.498,0.936&quot;&gt;
                    &lt;GradientStop Color=&quot;#FF8392AD&quot; Offset=&quot;0.004&quot;/&gt;
                    &lt;GradientStop Color=&quot;#FFE2E5EA&quot; Offset=&quot;1&quot;/&gt;
                &lt;/LinearGradientBrush&gt;
            &lt;/TextBox.Background&gt;
            &lt;TextBox.Effect&gt;
                &lt;DropShadowEffect Direction=&quot;135&quot; ShadowDepth=&quot;2&quot;/&gt;
            &lt;/TextBox.Effect&gt;
        &lt;/TextBox&gt;
        &lt;Button x:Name=&quot;Button_Increment&quot; HorizontalAlignment=&quot;Left&quot; Margin=&quot;8,80,0,0&quot; Width=&quot;100&quot; 
            Content=&quot;+&quot; FontFamily=&quot;Arial&quot; FontSize=&quot;16&quot; ToolTip=&quot;値を１つ加算します。&quot; Height=&quot;50&quot;
            VerticalAlignment=&quot;Top&quot; /&gt;
        &lt;Button x:Name=&quot;Button_Decrement&quot; Margin=&quot;0,80,0,0&quot; <code>Width=&quot;100&quot; Height=&quot;50&quot;</code>
            Content=&quot;-&quot; FontFamily=&quot;Arial&quot; FontSize=&quot;16&quot; 
            ToolTip=&quot;値を１つ減算します。&quot; HorizontalAlignment=&quot;Center&quot; VerticalAlignment=&quot;Top&quot;/&gt;
        &lt;Button x:Name=&quot;Button_Clear&quot; Margin=&quot;0,80,8,0&quot; Content=&quot;Clear&quot; HorizontalAlignment=&quot;Right&quot;
            Width=&quot;100&quot; FontFamily=&quot;Arial&quot; FontSize=&quot;16&quot; ToolTip=&quot;値を０にクリアします。&quot; Height=&quot;50&quot;
            VerticalAlignment=&quot;Top&quot; /&gt;
        &lt;Rectangle Fill=&quot;White&quot; Margin=&quot;8,14.6,8,0&quot; VerticalAlignment=&quot;Top&quot; Height=&quot;13.6&quot; Opacity=&quot;0.85&quot;&gt;
            &lt;Rectangle.Effect&gt;
                &lt;BlurEffect Radius=&quot;10&quot;/&gt;
            &lt;/Rectangle.Effect&gt;
        &lt;/Rectangle&gt;
    &lt;/Grid&gt;
&lt;/Window&gt;</pre>

<p>&nbsp;</p>
<p>&nbsp;</p>

<h4><a name="3.2.3._TextBox_の_Text_を_DataContext_の_Counter.CountValue_へバインディング">3.2.3. TextBox の Text を DataContext の Counter.CountValue へバインディング</a></h4>

<p>TextBox の Text を DataContext の Counter.CountValue へデータ・バインディングします。</p>
<p>TextBox を選択後、Text の右側にある□をクリック、「データ・バインディング の作成...」を選びます。</p>
<p><img alt="Visual Studio 画面（４）" height="563" src="Counter/img24.jpg" width="1056"></p>
<p><img alt="Visual Studio 画面（５）" src="Counter/img27.jpg"></p>
<p>&nbsp;</p>
<p>「TextBox_CounterView.Text のデータ 
バインディングを作成」の画面を表示するので、パスから「CounterValue」を選択して「OK」ボタンを押します。</p>
<p><img alt="Visual Studio 画面（６）" src="Counter/img29.jpg"></p>
<p>&nbsp;</p>
<p>下図の画面になったら成功です。TextBox の Text が CountValue へ結びついて &quot;0&quot; を表示できるようになりました。</p>
<p><img alt="Visual Studio 画面（７）" height="558" src="Counter/img2A.jpg" width="1037"></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h4><a name="3.2.4._「＋」ボタンのコマンドを_Counter.IncrementCommand_へバインディング">3.2.4. 「＋」ボタンのコマンドを Counter.IncrementCommand へバインディング</a></h4>
<p>「＋」ボタンのコマンドを Counter.IncrementCommand へバインディングします。</p>
<p>「＋」ボタンを選択後、Command の右側にある□をクリック、</p>
<p>
<img alt="Visual Studio 画面（８）" height="540" src="Counter/img31.jpg" width="1011"></p>

<p>&nbsp;</p>

<p><img alt="Visual Studio 画面（９）" src="Counter/img35.jpg"></p>
<p><img alt="Visual Studio 画面（１０）" src="Counter/img32.jpg"></p>

<p>&nbsp;</p>
<p>パスから「IncrementCommand」を選択し、「OK」をクリックします。</p>
<p><img alt="Visual Studio 画面（１１）" src="Counter/img37.jpg"></p>

<p>&nbsp;</p>

<h4><a name="3.2.5._「－」、「Clear」ボタンのコマンドをバインディング">3.2.5. 「ー」、「Clear」ボタンのコマンドをバインディング</a></h4>

<p>3.2.4. と同様の手順で「ー」、「Clear」ボタンをバインディングします。</p>
<p>この時点の MainWindow.xaml.cs は以下の通りです。&nbsp;</p>

<pre class="prettyprint linenums">
&lt;Window
    xmlns=&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;
    xmlns:x=&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;
    xmlns:d=&quot;http://schemas.microsoft.com/expression/blend/2008&quot;
    xmlns:mc=&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot; mc:Ignorable=&quot;d&quot; 
    xmlns:CounterDll=&quot;clr-namespace:CounterDll;assembly=CounterDll&quot; x:Class=&quot;CounterWPF.Window1&quot;
    Title=&quot;Counter on the WPF&quot; Height=&quot;237.333&quot; Width=&quot;347.467&quot; 
    ResizeMode=&quot;NoResize&quot; Background=&quot;White&quot; Closing=&quot;Window_Closing&quot;&gt;
<span class="auto-style9">    &lt;Window.DataContext&gt;</span>
<span class="auto-style9">        &lt;CounterDll:Counter/&gt;</span>
<span class="auto-style9">    &lt;/Window.DataContext&gt;</span>
    &lt;Grid&gt;
        &lt;Button x:Name=&quot;Button_Quit&quot; HorizontalAlignment=&quot;Right&quot; Margin=&quot;8,0,8,8&quot; Width=&quot;100&quot; Content=&quot;Quit&quot;
            VerticalAlignment=&quot;Bottom&quot; Height=&quot;50&quot; FontFamily=&quot;Arial&quot; FontSize=&quot;16&quot; Click=&quot;Button_Click_Quit&quot;
            ToolTip=&quot;プログラムを終了します。&quot; /&gt;
        &lt;TextBox x:Name=&quot;TextBox_CounterView&quot; Margin=&quot;8,8,8,0&quot; VerticalAlignment=&quot;Top&quot; Height=&quot;59&quot;
            TextWrapping=&quot;Wrap&quot; FontFamily=&quot;Arial&quot; FontSize=&quot;48&quot; TextAlignment=&quot;Center&quot; IsReadOnly=&quot;True&quot;
            IsTabStop=&quot;False&quot; ToolTip=&quot;値を表示します。&quot; <span class="auto-style9">Text=&quot;{Binding CountValue}&quot;</span>&gt;
            &lt;TextBox.Background&gt;
                &lt;LinearGradientBrush EndPoint=&quot;0.496,0.022&quot; StartPoint=&quot;0.498,0.936&quot;&gt;
                    &lt;GradientStop Color=&quot;#FF8392AD&quot; Offset=&quot;0.004&quot;/&gt;
                    &lt;GradientStop Color=&quot;#FFE2E5EA&quot; Offset=&quot;1&quot;/&gt;
                &lt;/LinearGradientBrush&gt;
            &lt;/TextBox.Background&gt;
            &lt;TextBox.Effect&gt;
                &lt;DropShadowEffect Direction=&quot;135&quot; ShadowDepth=&quot;2&quot;/&gt;
            &lt;/TextBox.Effect&gt;
        &lt;/TextBox&gt;
        &lt;Button x:Name=&quot;Button_Increment&quot; HorizontalAlignment=&quot;Left&quot; Margin=&quot;8,80,0,0&quot; Width=&quot;100&quot; Content=&quot;+&quot; 
            FontFamily=&quot;Arial&quot; FontSize=&quot;16&quot; ToolTip=&quot;値を１つ加算します。&quot; Height=&quot;50&quot; VerticalAlignment=&quot;Top&quot;
            <span class="auto-style9">Command=&quot;{Binding IncrementCommand, Mode=OneWay}&quot;</span> /&gt;
        &lt;Button x:Name=&quot;Button_Decrement&quot; <code>HorizontalAlignment=&quot;Center&quot; </code>Margin=&quot;0,80,0,0&quot; Content=&quot;-&quot; <code>Width=&quot;100&quot;</code>
            FontFamily=&quot;Arial&quot; FontSize=&quot;16&quot; ToolTip=&quot;値を１つ減算します。&quot; VerticalAlignment=&quot;Top&quot; <code>Height=&quot;50&quot;</code>
            <span class="auto-style9">Command=&quot;{Binding DecrementCommand, Mode=OneWay}&quot;</span> /&gt;
        &lt;Button x:Name=&quot;Button_Clear&quot; Margin=&quot;0,80,8,0&quot; Content=&quot;Clear&quot; HorizontalAlignment=&quot;Right&quot; Width=&quot;100&quot;
            FontFamily=&quot;Arial&quot; FontSize=&quot;16&quot; ToolTip=&quot;値を０にクリアします。&quot; Height=&quot;50&quot; VerticalAlignment=&quot;Top&quot;
            <span class="auto-style9">Command=&quot;{Binding ClearCommand, Mode=OneWay}&quot;</span> /&gt;
        &lt;Rectangle Fill=&quot;White&quot; Margin=&quot;8,14.6,8,0&quot; VerticalAlignment=&quot;Top&quot; Height=&quot;13.6&quot; Opacity=&quot;0.85&quot;&gt;
            &lt;Rectangle.Effect&gt;
                &lt;BlurEffect Radius=&quot;10&quot;/&gt;
            &lt;/Rectangle.Effect&gt;
        &lt;/Rectangle&gt;
        
    &lt;/Grid&gt;
&lt;/Window&gt;</pre>

<p> &nbsp;</p>
<p> 以上で完成です。</p>
<p> <img alt="完成したプログラム画面" src="Counter/img3A.jpg"></p>
<p> &nbsp;</p>
<p> &nbsp;</p>

<section>
  <h2><a id="ライセンス">ライセンス</a></h2>
  <p>本ページの情報は、特記無い限り下記 MIT ライセンスで提供されます。</p>
  <div class="license">
    The MIT License (MIT)<br><br>
    
    Copyright © 2012-2022 Kinoshita Hidetoshi<br><br>
    
    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:<br><br>
    
    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.<br><br>
    
    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE.
  </div>
  <p>&nbsp;</p>
  <p>&nbsp;</p>
</section>

<p> &nbsp;</p>

<section>
	<h2><a id="参考">参考</a></h2>
	<ul>
		<li></li>
	</ul>
</section>

<p> &nbsp;</p>
<hr>
<p> &nbsp;</p>

<section>
	<h2 style="margin-bottom:5px">変更履歴</h2>
	<table>
	  <tr>
	    <td class="td_history_date">2022-08-10</td>
	    <td class="td_history_separator">-</td>
	    <td class="td_history">ページデザイン更新</td>
	  </tr>
	  <tr>
	    <td class="td_history_date">2016-05-03</td>
	    <td class="td_history_separator">-</td>
	    <td class="td_history">更新</td>
	  </tr>
	  <tr>
	    <td class="td_history_date">2012-05-16</td>
	    <td class="td_history_separator">-</td>
	    <td class="td_history">新規作成 </td>
	  </tr>
	</table>
</section>

<p>&nbsp;</p>

<section>
<p><a href="../../../index.html" target="_parent">Programming Items トップページ</a></p>
<p><a href="../../../privacy_policy.html">プライバシーポリシー</a></p>
</section>

<p>&nbsp;</p>

<footer>
	<p><small>Copyright © 2012-2022 Kinoshita Hidetoshi (木下英俊)</small></p>
</footer>

<p> &nbsp;</p>
</body>
</html>
