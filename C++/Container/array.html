<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="author" content="木下英俊">
  <meta name="description" content="木下英俊が自身のためにプログラムメモを残すことを目的に作成したページです。">
  <meta name="keywords" content="">
  <!-- キャッシュ無効化 -->
  <meta http-equiv="Cache-Control" content="no-cache">

  <!-- タイトル -->
  <title>std::array | Programming Items</title>

  <!-- ファビコン -->
  <link rel="shortcut icon" href="../../favicon.ico">
  
  <!-- CSS -->
  <link href="https://unpkg.com/ress/dist/ress.min.css" rel="stylesheet">
  <link rel="stylesheet" href="../../design.css" type="text/css">
  
	<!-- Start for 'google-code-prettify' -->
	<link href="../../prettify/styles/desert.css" rel="stylesheet" type="text/css">
	<script src="../../prettify/prettify.js" type="text/javascript"></script>
	<!-- End for 'google-code-prettify' -->	

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-V2DZQK54C2"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'G-V2DZQK54C2');
  </script>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  
  <style type="text/css">
    .auto-style3 {
      background-color: #505000;
    }
  </style>
</head>

<!-- Start for 'google-code-prettify' -->
<body onload="prettyPrint();">
<!-- End for 'google-code-prettify' -->

  <h1>std::array (c++11)</h1>
  <p><strong>std::array</strong> 
  は、固定長のオブジェクトを保持するシーケンスコンテナで、各要素は連続して格納される。従来のCスタイルの配列のパフォーマンスを保ったまま、シーケンスのサイズの取得、要素の代入のサポートなど、標準コンテナの恩恵を受ける事ができる。また、境界チェック（範囲外の要素にアクセスしようとしていないかのチェック）付きの要素アクセスもサポートしている。 </p>
  <p>&nbsp;</p>
  <div class="mokuji">
    <nav>
  	<h2>目次</h2>
  	<p><a href="#1._始めに">1. 始めに</a></p>
  	<p><a href="#2. std::array_で二次元配列">2. std::arrya で二次元配列</a></p>
  	<p><a href="#3._N次元配列">3. N次元配列</a></p>
  	<p>&nbsp;</p>
  	<p><a href="#ライセンス">ライセンス</a></p>
  	<p><a href="#参考">参考</a></p>
    </nav>
  </div>
  
  <p>&nbsp;</p>
  <p>&nbsp;</p>
  
  <section>
    <h2> <a name="1._始めに">1. 始めに</a></h2>
    <h4>[概要]</h4>
    <p>ja.cppreference.com に記載されているサンプルプログラムから作成してみます。<br>（少し変更しています。）</p>
    <p><a href="https://ja.cppreference.com/w/cpp/container/array" target="_blank">
    https://ja.cppreference.com/w/cpp/container/array</a></p>
    <p> &nbsp;</p>
    
    <h4>[環境]</h4>
    <table>
    <tbody>
    	<tr>
    		<td class="td_separate" colspan="3"></td>
    	</tr>
    	
    	<tr>
    		<td>コンパイラ :</td>
    		<td>g++ (Ubuntu 13.3.0-6ubuntu2~24.04) </td>
    		<td>13.3.0</td>
    	</tr>
    		
    	<tr>
    		<td>&nbsp;</td>
    		<td>Visual Studio 2022,</td>
    		<td>Version 17.2.4 </td>
    	</tr>
    	
    	<tr>
    		<td>&nbsp;</td>
    		<td>Visual Studio 2019 pro.,</td>
    		<td>Version 16.7.1 </td>
    	</tr>
    	
    	<tr>
    		<td class="td_separate" colspan="3"></td>
    	</tr>
    	
    	<tr>
    		<td>OS: </td>
    	    <td>Ubuntu,</td>
    	    <td>24.04 (WSL)</td>
    	  </tr>
    	
    	<tr>
    		<td>&nbsp;</td>
    	    <td>Windows11 home,</td>
    	    <td>21H2 </td>
    	  </tr>
    	
    	<tr>
    		<td>&nbsp;</td>
    		<td>Windows10 home,</td>
    		<td>Version 1909 </td>
    	</tr>
    	
    	<tr>
    		<td class="td_separate" colspan="3"></td>
    	</tr>
    </tbody>
    </table>
    
    <p> &nbsp;</p>
    <p> &nbsp;</p>
    <p> プログラム例： "array_01.cpp"</p>
    <pre class="prettyprint linenums lang-cpp" style="width: 800px">
/**
 * プログラム概要:
 * このプログラムは、C++標準ライブラリの std::array コンテナの基本的な使用方法をデモンストレーションします。
 * 具体的には、配列の初期化（集成体初期化を含む）、コンテナ操作（ソート、リバースコピー）、
 * および範囲forループを使用した要素の出力を行います。
 * std::arrayは固定サイズの配列を提供し、標準コンテナのインターフェースをサポートします。
 */

#include &lt;iostream&gt;     // std::cout
#include &lt;string&gt;       // std::string
#include &lt;array&gt;        // std::array
#include &lt;iterator&gt;     // std::ostream_iterator
#include &lt;algorithm&gt;    // std::sort, std::reverse_copy
 
int main()
{
    // 構築は集成体初期化を使用します。
    std::array&lt;int, 3&gt; a1{ {3, 1, 2} }; // CWG 1270 の改訂前の C++11 では二重の波括弧が必要です
                                        // (改定後の C++11 および C++14 以上では必要ありません)。
    std::array&lt;int, 3&gt; a2 = { 1, 2, 3 };  // = の後では必要ありません。
    std::array&lt;std::string, 2&gt; a3 = { std::string("a"), "b" };
 
    // コンテナ操作がサポートされています。
    // a1
    std::sort(a1.begin(), a1.end());
    std::copy(a1.begin(), a1.end(), std::ostream_iterator&lt;int&gt;(std::cout, " "));
    std::cout &lt;&lt; '\n';
    // a2
    std::reverse_copy(a2.begin(), a2.end(), std::ostream_iterator&lt;int&gt;(std::cout, " "));
    std::cout &lt;&lt; '\n';
 
    // 範囲 for ループがサポートされています。
    // a3
    for (const auto&amp; s : a3) {
        std::cout &lt;&lt; s &lt;&lt; ' ';
    }

    std::cout &lt;&lt; '\n';
    
    return 0;
}</pre>

    <p> &nbsp;</p>
    
    <p> ビルド方法例（g++）：</p>  
    <pre class="prettyprint lang-bsh" style="width: 800px">$ g++ -std=c++23 -Wall -Wextra -Wpedantic array_01.cpp -o array_01.out</pre>
    
    <p> &nbsp;</p>
    <p>実行結果：</p>
    <pre class="prettyprint lang-bsh" style="width: 800px">
$ ./array_01.out
1 2 3
3 2 1
a b
$</pre>

    <p>&nbsp;</p>

  </section>

  <p>&nbsp;</p>

  <section>
    <h2><a name="2. std::array_で二次元配列">2. std::array で二次元配列</a></h2>
    <p>&nbsp;c++11では、std::array はあるけれども std::multi_array がありません。つまり 
    boost::multi_array に相当するコンテナが無いのです。<br>しょうがないので std::array で multi_array 
    相当のことができることを以下で確認してみます。たぶん下記のような内容で等価のことをできると判断し、不要と判断されたのかと。<br>それからイニシャライザーリストの書き方ですが、下記の通り中括弧が３階層必要です。一番外側の中括弧は不要に思えるのですが、これを省略するとエラーになってしまいます。</p>
    <p>&nbsp;</p>
    
    <h4>[環境]</h4>
    <table>
    <tbody>
    	<tr>
    		<td class="td_separate" colspan="3"></td>
    	</tr>
    	
    	<tr>
    		<td>コンパイラ :</td>
    		<td>g++ (Ubuntu 13.3.0-6ubuntu2~24.04) </td>
    		<td>13.3.0</td>
    	</tr>
    		
    	<tr>
    		<td>&nbsp;</td>
    		<td>Visual Studio 2022,</td>
    		<td>Version 17.2.4 </td>
    	</tr>
    	
    	<tr>
    		<td>&nbsp;</td>
    		<td>Visual Studio 2019 pro.,</td>
    		<td>Version 16.7.1 </td>
    	</tr>
    	
    	<tr>
    		<td class="td_separate" colspan="3"></td>
    	</tr>
    	
    	<tr>
    		<td>OS: </td>
    	    <td>Ubuntu,</td>
    	    <td>24.04 (WSL)</td>
    	  </tr>
    	
    	<tr>
    		<td>&nbsp;</td>
    	    <td>Windows11 home,</td>
    	    <td>21H2 </td>
    	  </tr>
    	
    	<tr>
    		<td>&nbsp;</td>
    		<td>Windows10 home,</td>
    		<td>Version 1909 </td>
    	</tr>
    	
    	<tr>
    		<td class="td_separate" colspan="3"></td>
    	</tr>
    </tbody>
    </table>
    
    <p> &nbsp;</p>
    <p> &nbsp;</p>
    <p> プログラム例： "array_02.cpp"</p>

    <pre class="prettyprint linenums lang-cpp" style="width: 800px">
/**
 * プログラム概要:
 * このプログラムは、C++ の `std::array` を使用して 2 次元配列を作成する例を示します。
 * 大きさ `5 x 3` の整数型 2 次元配列を初期化し、各要素をコンソールに出力します。
 * 出力後、ユーザーが Enter キーを押すまで待機します。
 */

#include &lt;iostream&gt; // cout, endl
#include &lt;string&gt;   // string, getline
#include &lt;array&gt;    // array

int main([[maybe_unused]] int argc, [[maybe_unused]] char* argv[])
{
    const std::size_t SIZE_X = 5;
    const std::size_t SIZE_Y = 3;

    std::array&lt;std::array&lt;int, SIZE_X&gt;, SIZE_Y&gt; matrix = {
        std::array&lt;int, SIZE_X&gt;{0, 1, 2, 3, 4},
        std::array&lt;int, SIZE_X&gt;{1, 2, 3, 4, 5},
        std::array&lt;int, SIZE_X&gt;{2, 3, 4, 5, 6},
    };

    // 配列の内容を出力(1)
    for (const auto&amp; row : matrix) {
        for (const auto&amp; value : row) {
            std::cout &lt;&lt; value &lt;&lt; ' ';
        }
        std::cout &lt;&lt; std::endl;
    }
    std::cout &lt;&lt; std::endl;

    // 配列の内容を出力(2)
    for ( size_t y=0; y&lt;matrix.size(); ++y ){
        for ( size_t x=0; x&lt;matrix[y].size(); ++x ){
            std::cout &lt;&lt; matrix[y][x] &lt;&lt; " " ;
        }
        std::cout &lt;&lt; std::endl;
    }
    std::cout &lt;&lt; std::endl;

    std::cout &lt;&lt; "HIT [Enter] KEY !! ";
    std::string input_line;
    std::getline(std::cin, input_line);

    return 0;
}</pre>

    <p> &nbsp;</p>
    
    <p> ビルド方法例（g++）：</p>  
    <pre class="prettyprint lang-bsh" style="width: 800px">$ g++ -std=c++23 -Wall -Wextra -Wpedantic array_02.cpp -o array_02.out</pre>
    
    <p> &nbsp;</p>
    <p> 実行結果：</p>
    
    <pre class="prettyprint lang-bsh" style="width: 800px">
$ ./array_02.out 
0 1 2 3 4 
1 2 3 4 5 
2 3 4 5 6 

0 1 2 3 4 
1 2 3 4 5 
2 3 4 5 6 

HIT [Enter] KEY !! 
$</pre>

    <p> &nbsp;</p>
    <p>機能としてこれで十分に見えます。固定長配列なので、関数なんかで引数として渡す場合も typedef すればまったく問題を感じませんね。</p>
    <p>&nbsp;</p>
  </section>
  
  <p>&nbsp;</p>
  
  <section>
    <h2><a name="3._N次元配列">3. N次元配列</a></h2>
    <p>同じ要領でN次元の配列も作成可能です。<br>が、型の宣言が std::array&lt; std::array&lt; std::array&lt; ･･･, N3&gt;, 
    N2&gt;, N1&gt; という感じになって面倒です。<br>何か良い方法がないかとインターネットを検索していたら... よさそうなネタがありました。<br>
    結局展開されれば同じことなのですが、わかりやすいこと、template の使い方の良い勉強になること、で素晴らしいコードと思いました。勉強になります。<br>以下に紹介します。</p>
    <p>引用元： <code>
    <a href="http://koturn.hatenablog.com/entry/2018/08/02/000000" target="_blank">http://koturn.hatenablog.com/entry/2018/08/02/000000</a></code></p>
    <p>&nbsp;</p>
    
    <h4>[環境]</h4>
    <table>
    <tbody>
    	<tr>
    		<td class="td_separate" colspan="3"></td>
    	</tr>
    	
    	<tr>
    		<td>コンパイラ :</td>
    		<td>Visual Studio 2022,</td>
    		<td>Version 17.2.4 </td>
    	</tr>
    	
    	<tr>
    		<td>&nbsp;</td>
    		<td>Visual Studio 2010</td>
    		<td>&nbsp;</td>
    	</tr>
    	
    	<tr>
    		<td class="td_separate" colspan="3"></td>
    	</tr>
    	
    	<tr>
    		<td>OS: </td>
    	    <td>Windows11 home,</td>
    	    <td>21H2 </td>
    	</tr>
    	
    	<tr>
    		<td>&nbsp;</td>
    		<td>Windows7 Proffesional 64bit 日本語版</td>
    		<td>&nbsp;</td>
    	</tr>
    	
    	<tr>
    		<td class="td_separate" colspan="3"></td>
    	</tr>
    </tbody>
    </table>

    <p>&nbsp;</p>
    <h4>[プログラムソース]</h4>

    <pre class="prettyprint linenums"><code>#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;array&gt;


template&lt;typename T, std::size_t N, std::size_t... Extents&gt;
struct extents_expander
    : extents_expander&lt;std::array&lt;T, N&gt;, Extents...&gt;
{};  // struct extents_expander

template&lt;typename T, std::size_t N&gt;
struct extents_expander&lt;T, N&gt;
{
    using type = std::array&lt;T, N&gt;;
};  // struct extents_expander

template&lt;typename T, std::size_t... Extents&gt;
struct ndarray_helper
{
    using type = typename extents_expander&lt;T, Extents...&gt;::type;
};  // struct ndarray_helper

template&lt;typename T, std::size_t N, std::size_t... Extents&gt;
struct ndarray_helper&lt;T[N], Extents...&gt;
{
    using type = typename ndarray_helper&lt;T, N, Extents...&gt;::type;
};  // struct ndarray_helper

template&lt;typename T&gt;
using NdArray = typename ndarray_helper&lt;T&gt;::type;


int main()
{
    const size_t X = 10;
    const size_t Y = 20;
    const size_t Z = 30;

    static <span class="auto-style3">NdArray&lt;int[X][Y][Z]&gt;</span> array;     // NdArray&lt;int[X][Y][Z]&gt; 
                                            // = ndarray_helper&lt;int[X][Y][Z]&gt;
                                            // = ndarray_helper&lt;int[Y][Z], X&gt;
                                            // = ndarray_helper&lt;int[Z], Y, X&gt;
                                            // = ndarray_helper&lt;int, Z, Y, X&gt;
                                            // = extents_expander&lt;int, Z, Y, X&gt;
                                            // = extents_expander&lt;std::array&lt;int, Z&gt;, Y, X&gt;
                                            // = extents_expander&lt;std::array&lt; std::array&lt;int, Z&gt;, Y&gt;, X&gt;
                                            // = <span class="auto-style3">std::array&lt;std::array&lt; std::array&lt;int, Z&gt;, Y&gt;, X&gt;</span>

    int count = 0;

    for (int i = 0; i &lt; X; i++) {
        for (int j = 0; j &lt; Y; j++) {
            for (int k = 0; k &lt; Z; k++) {
                array[i][j][k] = count++;
            }
        }
    }

    for (auto x : array) {
        for (auto y : x) {
            std::copy(y.begin(), y.end(), std::ostream_iterator&lt;int&gt;(std::cout, &quot; &quot;));
            std::cout &lt;&lt; std::endl;
        }
    }

    return EXIT_SUCCESS;
}</code></pre>

    <h4>[実行結果]</h4>
    <p>割愛</p>
  </section>

  <p>&nbsp;</p>

  <section>
    <h2><a name="ライセンス">ライセンス</a></h2>
    <p>本ページの情報は、特記無い限り下記 MIT ライセンスで提供されます。</p>
    <table class="border-collapse" style="width: 600px; background-color: #F0F0F0; word-break: break-word;">
      <tr>
        <td>
          MIT License<br><br>

              Copyright (c) 2012  Kinoshita Hidetoshi<br><br>

          Permission is hereby granted, free of charge, to any person obtaining a copy
          of this software and associated documentation files (the "Software"), to deal
          in the Software without restriction, including without limitation the rights
          to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
          copies of the Software, and to permit persons to whom the Software is
          furnished to do so, subject to the following conditions:<br><br>

          The above copyright notice and this permission notice shall be included in all
          copies or substantial portions of the Software.<br><br>

          THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
          IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
          FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
          AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
          LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
          OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
          SOFTWARE.
        </td>
      </tr>
    </table>
    <p>&nbsp;</p>
    <p>&nbsp;</p>
  </section>

  <p>&nbsp;</p>
    
  <section>
    <h2><a name="参考">参考</a></h2>
    <ul>
      <li>
        <a href="https://cpprefjp.github.io/reference/array/array.html" target="_blank">
        array - cpprefjp C++日本語リファレンス</a></li>
      <li>cppreference.com<br>
        <a href="https://ja.cppreference.com/w/cpp/container/array" target="_blank">
          https://ja.cppreference.com/w/cpp/container/array</a></li>
      <li>多次元の std::array を楽に扱う - kotumの日記<br>
        <a href="http://koturn.hatenablog.com/entry/2018/08/02/000000" target="_blank">
          http://koturn.hatenablog.com/entry/2018/08/02/000000</a></li>
    </ul>
    <p>&nbsp;</p>
  </section>

  <hr>

  <p>&nbsp;</p>

  <section>
    <h2 style="margin-bottom:5px">変更履歴</h2>
    <table>
      <tr>
        <td class="td_history_date">2025-11-24</td>
        <td class="td_history_separator">-</td>
        <td class="td_history">サンプルコードを更新</td>
      </tr>
      <tr>
        <td class="td_history_date">2022-06-22</td>
        <td class="td_history_separator">-</td>
        <td class="td_history">評価環境として VS2022、Windows11 を追加</td>
      </tr>
      <tr>
        <td class="td_history_date">2020-08-18</td>
        <td class="td_history_separator">-</td>
        <td class="td_history">「3. N次元配列」を追加。</td>
      </tr>
      <tr>
        <td class="td_history_date">2020-08-12</td>
        <td class="td_history_separator">-</td>
        <td class="td_history">画面構成をメンテ。vector, deque 
      の書式と統一。</td>
      </tr>
      <tr>
        <td class="td_history_date"></td>
        <td class="td_history_separator">-</td>
        <td class="td_history">&quot;1.始めに&quot; を刷新。</td>
      </tr>
      <tr>
        <td class="td_history_date">2012-02-26</td>
        <td class="td_history_separator">-</td>
        <td class="td_history">新規作成 </td>
      </tr>
    </table>
  </section>

  <p>&nbsp;</p>

  <section>
  <p><a href="../../index.html" target="_parent">Programming Items トップページ</a></p>
  <p><a href="../../privacy_policy.html">プライバシーポリシー</a></p>
  </section>

  <p>&nbsp;</p>

  <footer>
    <p><small>© copyright 2012 木下英俊</small></p>
  </footer>

  <p>&nbsp;</p>

</body>
</html>
