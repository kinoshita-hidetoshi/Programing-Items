<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Counter (Win32)</title>
<link rel="stylesheet" href="../../design.css" type="text/css">
<style type="text/css">
.auto-style7 {
	font-weight: normal;
}
.auto-style8 {
	border-collapse: collapse;
	text-align: justify;
	font-size: 10.0pt;
	font-family: Century;
	border: 1.0pt solid windowtext;
}
.auto-style9 {
	background-color: #FFFF00;
}
</style>
</head>
<body>
<h1 class="auto-style7">
Counter (Win32)</h1>
<p class="auto-style7">
職場の若手向けお勉強テーマとして作成しました。Win32 で下記の機能を実現しなさい、という内容です。</p>
<h2>
１．要求仕様</h2>
<h3>
1.1. 機能</h3>
<ul>
	<li>アプリケーションはカウンタの値を表示する機能を持つ。</li>
	<li>アプリケーション起動時のカウンタ初期値を０とする。</li>
	<li>ボタンAを押すと、カウンタの値を１加算する。</li>
	<li>ボタンBを押すと、カウンタの値を1減算する。</li>
	<li>ボタンCを押すと、カウンタの値を０にクリアする。</li>
	<li>
	ボタンDを押すと、終了確認ダイアログを表示し、はい(またはYes)を押下したらアプリケーションを終了する。いいえ（またはNo）を押下した場合はアプリケーションを終了せずに動作を継続する。</li>
	<li>カウンタの値範囲を０～１０とする。</li>
	<li>カウンタが0のとき、”-”ボタンを無効化すること。</li>
	<li>カウンタが 10 のとき、”+”ボタンを無効化すること。</li>
</ul>
<h3><![if !supportLists]><span style="mso-list:Ignore">
<span style="font-family:
&quot;Meiryo UI&quot;">1.2. </span></span><![endif]>
<span style="font-family:&quot;Meiryo UI&quot;">画面仕様<span lang="EN-US"><o:p></o:p></span></span></h3>
<p class="MsoNormal"><span style="font-family:&quot;Meiryo UI&quot;">
画面仕様は以下の通り。記載事項以外は自由に設計のこと。<span lang="EN-US"><o:p></o:p></span></span></p>
<ul>
	<li>
	<p class="MsoNormal"><span style="font-family: &quot;Meiryo UI&quot;">フォント：<span lang="EN-US"> 
	Arial<o:p></o:p></span></span></p>
	</li>
</ul>
<p class="MsoNormal">
<o:p><img alt="" height="348" src="Counter/clip_image001.gif" width="564"></o:p></p>
<p>
<table border="1" cellpadding="0" cellspacing="0" class="auto-style8" style="mso-border-alt: solid windowtext .5pt; mso-yfti-tbllook: 480; mso-padding-alt: 0mm 5.4pt 0mm 5.4pt; mso-border-insideh: .5pt solid windowtext; mso-border-insidev: .5pt solid windowtext; text-justify: inter-ideograph;">
	<tr style="mso-yfti-irow: 0; mso-yfti-firstrow: yes">
		<td style="width: 32.4pt; border: solid windowtext 1.0pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt" width="54">
		<p class="MsoNormal"><span style="font-family: &quot;Meiryo UI&quot;">項番<span lang="EN-US"><o:p></o:p></span></span></p>
		</td>
		<td style="width: 90.0pt; border: solid windowtext 1.0pt; border-left: none; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt" width="150">
		<p class="MsoNormal"><span style="font-family: &quot;Meiryo UI&quot;">概要<span lang="EN-US"><o:p></o:p></span></span></p>
		</td>
		<td style="width: 51.3pt; border: solid windowtext 1.0pt; border-left: none; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt" width="86">
		<p class="MsoNormal"><span style="font-family: &quot;Meiryo UI&quot;">
		ｺﾝﾄﾛｰﾙ<span lang="EN-US"><o:p></o:p></span></span></p>
		</td>
		<td style="border-right: 1.0pt solid windowtext; border-top: 1.0pt solid windowtext; border-bottom: 1.0pt solid windowtext; width: 52pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; border-left-style: none; border-left-color: inherit; border-left-width: medium;">
		<p class="MsoNormal"><span style="font-family: &quot;Meiryo UI&quot;">
		ﾀﾌﾞ<o:p>ｵｰﾀﾞｰ</o:p></span></p>
		</td>
		<td style="border-right: 1.0pt solid windowtext; border-top: 1.0pt solid windowtext; border-bottom: 1.0pt solid windowtext; width: 148pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; border-left-style: none; border-left-color: inherit; border-left-width: medium;">
		<p class="MsoNormal"><span style="font-family: &quot;Meiryo UI&quot;">
		文字列、文字種別、他<span lang="EN-US"><o:p></o:p></span></span></p>
		</td>
		<td style="border-right: 1.0pt solid windowtext; border-top: 1.0pt solid windowtext; border-bottom: 1.0pt solid windowtext; width: 171pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; border-left-style: none; border-left-color: inherit; border-left-width: medium;">
		<p class="MsoNormal"><span style="font-family: &quot;Meiryo UI&quot;">他<span lang="EN-US"><o:p></o:p></span></span></p>
		</td>
	</tr>
	<tr style="mso-yfti-irow: 1">
		<td style="width: 32.4pt; border: solid windowtext 1.0pt; border-top: none; mso-border-top-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt" valign="top" width="54">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">1<o:p></o:p></span></p>
		</td>
		<td style="width: 90.0pt; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt" valign="top" width="150">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;"><o:p>&nbsp;</o:p></span></p>
		</td>
		<td style="width: 51.3pt; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt" valign="top" width="86">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">-<o:p></o:p></span></p>
		</td>
		<td style="width: 52pt; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;"><o:p>&nbsp;</o:p></span></p>
		</td>
		<td style="width: 148pt; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">“Counter”<o:p></o:p></span></p>
		</td>
		<td style="width: 171pt; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">Window</span><span style="font-family: &quot;Meiryo UI&quot;">サイズ：<span lang="EN-US">800</span>×<span lang="EN-US">600</span>以内<span lang="EN-US"><o:p></o:p></span></span></p>
		</td>
	</tr>
	<tr style="mso-yfti-irow: 2">
		<td style="width: 32.4pt; border: solid windowtext 1.0pt; border-top: none; mso-border-top-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt" valign="top" width="54">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">2<o:p></o:p></span></p>
		</td>
		<td style="width: 90.0pt; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt" valign="top" width="150">
		<p class="MsoNormal"><span style="font-family: &quot;Meiryo UI&quot;">
		値表示部<span lang="EN-US"><o:p></o:p></span></span></p>
		</td>
		<td style="width: 51.3pt; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt" valign="top" width="86">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">TextBox<o:p></o:p></span></p>
		</td>
		<td style="width: 52pt; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">(*1)<o:p></o:p></span></p>
		</td>
		<td style="width: 148pt; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">Number,
		</span><span style="font-family: &quot;Meiryo UI&quot;">値範囲<span lang="EN-US">:0</span>～<span lang="EN-US">10<o:p></o:p></span></span></p>
		</td>
		<td style="width: 171pt; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top">
		<p class="MsoNormal"><span style="font-family: &quot;Meiryo UI&quot;">
		フォントサイズ：<span lang="EN-US">36pt<o:p></o:p></span></span></p>
		<p class="MsoNormal"><span style="font-family: &quot;Meiryo UI&quot;">
		センター表示<span lang="EN-US"><o:p></o:p></span></span></p>
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">ReadOnly<o:p></o:p></span></p>
		</td>
	</tr>
	<tr style="mso-yfti-irow: 3">
		<td style="width: 32.4pt; border: solid windowtext 1.0pt; border-top: none; mso-border-top-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt" valign="top" width="54">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">3<o:p></o:p></span></p>
		</td>
		<td style="width: 90.0pt; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt" valign="top" width="150">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">+1<o:p></o:p></span></p>
		</td>
		<td style="width: 51.3pt; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt" valign="top" width="86">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">Button<o:p></o:p></span></p>
		</td>
		<td style="width: 52pt; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">1<o:p></o:p></span></p>
		</td>
		<td style="width: 148pt; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">“+”<o:p></o:p></span></p>
		</td>
		<td style="width: 171pt; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top">
		<p class="MsoNormal"><span style="font-family: &quot;Meiryo UI&quot;">
		フォントサイズ：<span lang="EN-US">12pt<o:p></o:p></span></span></p>
		</td>
	</tr>
	<tr style="mso-yfti-irow: 4">
		<td style="width: 32.4pt; border: solid windowtext 1.0pt; border-top: none; mso-border-top-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt" valign="top" width="54">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">4<o:p></o:p></span></p>
		</td>
		<td style="width: 90.0pt; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt" valign="top" width="150">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">-1<o:p></o:p></span></p>
		</td>
		<td style="width: 51.3pt; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt" valign="top" width="86">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">Button<o:p></o:p></span></p>
		</td>
		<td style="width: 52pt; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">2<o:p></o:p></span></p>
		</td>
		<td style="width: 148pt; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">“-“<o:p></o:p></span></p>
		</td>
		<td style="width: 171pt; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top">
		<p class="MsoNormal"><span style="font-family: &quot;Meiryo UI&quot;">
		フォントサイズ：<span lang="EN-US">12pt<o:p></o:p></span></span></p>
		</td>
	</tr>
	<tr style="mso-yfti-irow: 5">
		<td style="width: 32.4pt; border: solid windowtext 1.0pt; border-top: none; mso-border-top-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt" valign="top" width="54">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">5<o:p></o:p></span></p>
		</td>
		<td style="width: 90.0pt; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt" valign="top" width="150">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">0</span><span style="font-family: &quot;Meiryo UI&quot;">クリア<span lang="EN-US"><o:p></o:p></span></span></p>
		</td>
		<td style="width: 51.3pt; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt" valign="top" width="86">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">Button<o:p></o:p></span></p>
		</td>
		<td style="width: 52pt; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">3<o:p></o:p></span></p>
		</td>
		<td style="width: 148pt; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">“Clear”<o:p></o:p></span></p>
		</td>
		<td style="width: 171pt; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top">
		<p class="MsoNormal"><span style="font-family: &quot;Meiryo UI&quot;">
		フォントサイズ：<span lang="EN-US">12pt<o:p></o:p></span></span></p>
		</td>
	</tr>
	<tr style="mso-yfti-irow: 6; mso-yfti-lastrow: yes">
		<td style="border-left: 1.0pt solid windowtext; border-right: 1.0pt solid windowtext; border-bottom: 1.0pt solid windowtext; width: 32.4pt; mso-border-top-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; height: 69px; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top" width="54">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">6<o:p></o:p></span></p>
		</td>
		<td style="width: 90.0pt; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; height: 69px; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top" width="150">
		<p class="MsoNormal"><span style="font-family: &quot;Meiryo UI&quot;">
		プログラム<span lang="EN-US"><o:p></o:p></span></span></p>
		<p class="MsoNormal"><span style="font-family: &quot;Meiryo UI&quot;">
		終了ボタン<span lang="EN-US"><o:p></o:p></span></span></p>
		</td>
		<td style="width: 51.3pt; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; height: 69px; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top" width="86">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">Button<o:p></o:p></span></p>
		</td>
		<td style="width: 52pt; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; height: 69px; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">0<o:p></o:p></span></p>
		</td>
		<td style="width: 148pt; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; height: 69px; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top">
		<p class="MsoNormal">
		<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">“Quit”<o:p></o:p></span></p>
		</td>
		<td style="width: 171pt; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-alt: solid windowtext .5pt; padding: 0mm 5.4pt 0mm 5.4pt; height: 69px; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-top-style: none; border-top-color: inherit; border-top-width: medium;" valign="top">
		<p class="MsoNormal"><span style="font-family: &quot;Meiryo UI&quot;">
		フォントサイズ：<span lang="EN-US">12pt<o:p></o:p></span></span></p>
		</td>
	</tr>
</table>
</p>
<p>
<span lang="EN-US" style="font-size: 10.5pt; mso-bidi-font-size: 12.0pt; font-family: &quot;Meiryo UI&quot;; mso-font-kerning: 1.0pt; mso-ansi-language: EN-US; mso-fareast-language: JA; mso-bidi-language: AR-SA">
(*1) TabStop </span>
<span style="font-size: 10.5pt; mso-bidi-font-size: 12.0pt; font-family: &quot;Meiryo UI&quot;; mso-font-kerning: 1.0pt; mso-ansi-language: EN-US; mso-fareast-language: JA; mso-bidi-language: AR-SA">
を<span lang="EN-US"> False </span>に設定</span></p>
<p class="MsoNormal"><![if !supportLists]>
<span lang="EN-US" style="font-family: &quot;Meiryo UI&quot;">
<span style="mso-list: Ignore">1.<span lang="ja">3</span>.<span style="font: 7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style="font-family: &quot;Meiryo UI&quot;">
動作環境、開発環境<span lang="EN-US"><o:p></o:p></span></span></p>
<p class="MsoNormal"><span style="font-family: &quot;Meiryo UI&quot;">動作環境：<span lang="EN-US"> 
Windows XP </span>または<span lang="EN-US"> Windows7<o:p><br></o:p>
</span>開発環境：<span lang="EN-US"> Visual Studio 2008 </span>以降<span lang="EN-US"><o:p><br></o:p>
</span>開発言語：<span lang="EN-US"> Win32<o:p></o:p></span></span></p>
<p>&nbsp;</p>
<p>実際に私が作成したプログラムの画面は下図の通り。</p>
<p><img alt="" height="321" src="Counter/Counter_Win32.png" width="466"></p>
<p><span class="table_title">[プログラムソース（抜粋）]</span></p>

<table style="border: medium double #C0C0C0; width: 800px">
	<tr>
		<td>
		<pre><code>
<span class="comment">// Windows ヘッダー ファイル:</span>
<span class="command">#include</span> <span class="string">&lt;windows.h&gt;</span>
<span class="command">#include</span> <span class="string">&lt;windowsx.h&gt;</span>       <span class="comment">// SetWindowFont</span>

<span class="comment">// C ランタイム ヘッダー ファイル</span>
<span class="command">#include</span> <span class="string">&lt;stdlib.h&gt;</span>
<span class="command">#include</span> <span class="string">&lt;malloc.h&gt;</span>
<span class="command">#include</span> <span class="string">&lt;memory.h&gt;</span>
<span class="command">#include</span> <span class="string">&lt;tchar.h&gt;</span>          <span class="comment">// _tWinMain, _T</span>

<span class="command">#include</span> <span class="string">&quot;Resource.h&quot;</span>


<span class="comment">/*=========*/
/* #define */
/*=========*/</span>
<span class="command">#define</span> USE_SEND_MESSAGE    <span class="comment">// DlgProc 内で使用。機能実装方法の分岐に使用。</span>


<span class="comment">// グローバル変数:</span>
int count = 0 ;

<span class="comment">// このコード モジュールに含まれる関数の宣言を転送します</span>
LRESULT CALLBACK DlgProc(HWND, UINT, WPARAM, LPARAM);


int APIENTRY _tWinMain(HINSTANCE hCurInst,
                      HINSTANCE hPrevInst,
                      LPTSTR lpsCmdLine,
                      int nCmdShow)
{
    UNREFERENCED_PARAMETER(hPrevInst);
    UNREFERENCED_PARAMETER(lpsCmdLine);

    DialogBox(hCurInst, MAKEINTRESOURCE(IDD_DIALOG1), NULL, (DLGPROC)DlgProc);
    return 0;
}


LRESULT CALLBACK DlgProc(HWND hWnd, UINT msg, WPARAM wp, LPARAM lp)
{
    static HFONT font1 ;                    <span class="comment">// IDC_EDIT1 用のフォント</span>
    static const int nCountMin =  0 ;       <span class="comment">// カウンタ値 下限値</span>
    static const int nCountMax = 10 ;       <span class="comment">// カウンタ値 上限値</span>


    switch (msg) {
    case WM_DESTROY:
        break ;

    case WM_CLOSE:
        if (MessageBox(
            hWnd,
            (LPCTSTR)_T(<span class="string">&quot;プログラムを終了してよろしいですか？&quot;</span>),
            (LPCTSTR)_T(<span class="string">&quot;終了確認&quot;</span>),
            MB_YESNO | MB_ICONQUESTION) == IDNO)
        {
            <span class="comment">// プログラムを終了しない</span>
            return FALSE;
        }

        <span class="comment">// プログラムを終了する</span>
        EndDialog(hWnd, IDOK);
        return TRUE ;

    case WM_INITDIALOG:

        <span class="comment">/* IDC_EDIT1 のフォントを変更 */</span>
        {

            // フォント作成
            int PointSize = 36 ;    <span class="comment">// 36pt のフォントを作成します。</span>
            font1 = CreateFont(
                -MulDiv(PointSize, GetDeviceCaps(GetDC(hWnd), LOGPIXELSY), 72),
                0,                          // nWidth
                0,                          // nEscapement
                0,                          // nOrientation
                FW_NORMAL,                  // nWeight
                FALSE,                      // bItalic
                FALSE,                      // bUnderline
                0,                          // cStrikeOut
                ANSI_CHARSET,               // nCharSet
                OUT_DEFAULT_PRECIS,         // nOutPrecision
                CLIP_DEFAULT_PRECIS,        // nClipPrecision
                DEFAULT_QUALITY,            // nQuality
                DEFAULT_PITCH | FF_SWISS,   // nPitchAndFamily
                _T(&quot;Arial&quot;));               // lpszFacename

           <span class="comment"> /* フォントをコントロールへ設定 */
            /*
            ===============================================================================
                補足説明：
                    API SetWindowsFont は windowsx.h 内でマクロ定義されています。
                    下記２つの実装は、表現上は異なりますが、マクロを展開すると
                    同じ内容になります。
            ===============================================================================
            *</span>/
<span class="command">#ifdef</span> USE_SEND_MESSAGE
            // IDC_EDIT1
            SendMessage( GetDlgItem( hWnd, IDC_EDIT1 ), WM_SETFONT, (WPARAM)font1, (LPARAM)1);
<span class="command">#else</span>
            // IDC_EDIT1
            SetWindowFont( GetDlgItem( hWnd, IDC_EDIT1 ), font1, TRUE );
<span class="command">#endif</span>
        }

        <span class="comment">// count を初期状態に</span>
        {
            count = 0 ;
            SetDlgItemInt( hWnd, IDC_EDIT1, count, TRUE );

            EnableWindow( GetDlgItem(hWnd, IDC_INCREMENT), TRUE);
            EnableWindow( GetDlgItem(hWnd, IDC_DECREMENT), FALSE);
        }
        return TRUE;

    case WM_COMMAND:
        switch (GET_WM_COMMAND_ID(wp, lp)) {
        case IDOK:
            SendMessage( hWnd, WM_CLOSE, 0, 0 );
            return TRUE;

        case IDC_INCREMENT:
            count++ ;
            SetDlgItemInt( hWnd, IDC_EDIT1, count, TRUE );

            if ( count==nCountMax ){
                EnableWindow( GetDlgItem(hWnd, IDC_INCREMENT), FALSE);
            }
            if ( count!=nCountMin ){
                EnableWindow( GetDlgItem(hWnd, IDC_DECREMENT), TRUE);
            }
            return TRUE;

        case IDC_DECREMENT:
            count-- ;
            SetDlgItemInt( hWnd, IDC_EDIT1, count, TRUE );

            if ( count!=nCountMax ){
                EnableWindow( GetDlgItem(hWnd, IDC_INCREMENT), TRUE);
            }
            if ( count==nCountMin ){
                EnableWindow( GetDlgItem(hWnd, IDC_DECREMENT), FALSE);
            }
            return TRUE;

        case IDC_CLEAR:
            count = 0 ;
            SetDlgItemInt( hWnd, IDC_EDIT1, count, TRUE );

            EnableWindow( GetDlgItem(hWnd, IDC_INCREMENT), TRUE);
            EnableWindow( GetDlgItem(hWnd, IDC_DECREMENT), FALSE);
            return TRUE;

        default:
            break;
        }
        break;

    default:
        break;
    }

    return FALSE;
}
</code></pre>
		</td>
	</tr>
</table>

<br>
<p> 「Win32 DialogBox」の雛形に使えそうなプログラムです。</p>
<p> なお、Windows XP 
以降のコモンコントロールを使用するためにはマニュフェストでコモンコントロールのバージョン情報を記載する必要があるそうです。以下のマニュフェストを準備し、コモンコントロールのバージョンを 
6.0.0.0 で指定します。<br>このマニュフェストが無いとビジュアル的に古い感じのダイアログになってしまいます。</p>
<code>
<table style="border: medium double #C0C0C0; width: 800px">
	<tr>
		<td>
		<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;assembly xmlns=&quot;urn:schemas-microsoft-com:asm.v1&quot; manifestVersion=&quot;1.0&quot;&gt;
&lt;assemblyIdentity
  version=&quot;1.0.0.0&quot;
  processorArchitecture=&quot;X86&quot;
  name=&quot;CounterWin32.exe&quot;
/&gt;
&lt;description&gt;.NET control deployment tool&lt;/description&gt;
&lt;dependency&gt;
  &lt;dependentAssembly&gt;
<span class="auto-style9">    &lt;assemblyIdentity</span>
<span class="auto-style9">      type=&quot;win32&quot;</span>
<span class="auto-style9">      name=&quot;Microsoft.Windows.Common-Controls&quot;</span>
<span class="auto-style9">      version=&quot;6.0.0.0&quot;</span>
<span class="auto-style9">      processorArchitecture=&quot;X86&quot;</span>
<span class="auto-style9">      publicKeyToken=&quot;6595b64144ccf1df&quot;</span>
<span class="auto-style9">      language=&quot;*&quot;</span>
<span class="auto-style9">    /&gt;</span>
  &lt;/dependentAssembly&gt;
&lt;/dependency&gt;
&lt;/assembly&gt;</pre>
		</td>
		</code>
	</tr>
</table>
<p> 以上です。</p>
<p> <a href="Counter/Counter_Win32_Dialog_vs2008.zip">サンプルプログラム ダウンロード (vs2008)</a><br>
<a href="Counter/Counter_Win32_Dialog_vs2012.zip">サンプルプログラム ダウンロード (vs2012)</a></p>
<hr>
<p> <font face="Meiryo UI">記載： 2012年5月16日 木下英俊<br>
更新： 2013年1月&nbsp; 2日 木下英俊</font></p>
</body>
</html>
